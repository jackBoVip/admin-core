/**
 * @admin-core/layout 公共样式
 * @description Tailwind CSS v4 布局样式系统，Vue 和 React 共用
 */

/* ============================================================
 * Tailwind CSS v4 自定义变体
 * @description 布局状态与 utility 变体绑定
 * ============================================================ */
@custom-variant sidebar-collapsed (:is(.layout-sidebar--collapsed, .layout-sidebar[data-collapsed="true"]) &);
@custom-variant sidebar-hidden (:is(.layout-sidebar--hidden, .layout-sidebar[data-hidden="true"]) &);
@custom-variant sidebar-light (:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) &);
@custom-variant sidebar-dark (:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) &);
@custom-variant header-hidden (:is(.layout-header--hidden, .layout-header[data-hidden="true"]) &);
@custom-variant header-light (:is(.layout-header--light, .layout-header[data-theme="light"]) &);
@custom-variant header-dark (:is(.layout-header--dark, .layout-header[data-theme="dark"]) &);
@custom-variant tabbar-light (.layout-tabbar--light &);
@custom-variant tabbar-dark (.layout-tabbar--dark &);
@custom-variant data-active ([data-state="active"] &);
@custom-variant data-disabled ([data-disabled="true"] &);
@custom-variant content-maximized (:is(body.layout-content-maximized, body[data-content-maximized="true"]) &);

/* ============================================================
 * 主题切换过渡（View Transitions）
 * ============================================================ */
@supports (view-transition-name: root) {
  :root {
    view-transition-name: root;
  }

  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation: none;
    mix-blend-mode: normal;
  }

  :root.dark::view-transition-old(root) {
    z-index: 1;
  }

  :root.dark::view-transition-new(root) {
    z-index: 9999;
  }

  :root:not(.dark)::view-transition-old(root) {
    z-index: 9999;
  }

  :root:not(.dark)::view-transition-new(root) {
    z-index: 1;
  }
}

/* ============================================================
 * 页面切换进度条
 * ============================================================ */
.layout-progress {
  position: fixed;
  top: 0;
  left: 0;
  z-index: calc(var(--layout-z-index-header, 210) + 5);
  width: 100%;
  height: 2px;
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--duration-layout-fast) var(--ease-layout);
}

.layout-progress[data-visible='true'] {
  opacity: 1;
}

.layout-progress__bar {
  height: 100%;
  width: 0%;
  background: var(--primary, #2563eb);
  transition: width var(--duration-layout-normal) var(--ease-layout);
  box-shadow: 0 0 10px var(--primary, #2563eb), 0 0 5px var(--primary, #2563eb);
}

@supports (color: color-mix(in oklch, red, red)) {
  .layout-progress__bar {
    box-shadow:
      0 0 10px color-mix(in oklch, var(--primary) 45%, transparent),
      0 0 5px color-mix(in oklch, var(--primary) 35%, transparent);
  }
}

/* ============================================================
 * 颜色方案（确保滚动条与系统深色模式无关）
 * ============================================================ */
html,
body {
  color-scheme: light !important;
}

html.dark,
html[data-theme='dark'],
body.dark,
body[data-theme='dark'] {
  color-scheme: dark !important;
}

/* 系统为深色但应用为浅色时，强制使用浅色滚动条 */
@media (prefers-color-scheme: dark) {
  html:not(.dark):not([data-theme='dark']),
  body:not(.dark):not([data-theme='dark']) {
    color-scheme: light !important;
  }

  html[data-platform='macOs']:not(.dark):not([data-theme='dark'])::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  html[data-platform='macOs']:not(.dark):not([data-theme='dark'])::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
    border: none;
  }

  html[data-platform='macOs']:not(.dark):not([data-theme='dark'])::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 4px;
    border: none;
    box-shadow: none;
  }

  html[data-platform='macOs']:not(.dark):not([data-theme='dark'])::-webkit-scrollbar-button {
    display: none;
  }
}

/* ============================================================
 * 页面滚动条占位，避免覆盖内容区（与常见 admin 布局行为一致）
 * ============================================================ */
html,
body {
  overflow-y: auto;
  background-color: var(--background, #ffffff);
  color: var(--foreground, #0f172a);
}

/* 仅非 mac 平台启用自定义滚动条（与常见 admin 布局保持一致） */
html:not([data-platform='macOs']),
body:not([data-platform='macOs']) {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb, var(--border)) transparent;
}

html:not([data-platform='macOs'])::-webkit-scrollbar,
body:not([data-platform='macOs'])::-webkit-scrollbar {
  width: var(--scrollbar-width, 10px);
  height: var(--scrollbar-width, 10px);
}

html:not([data-platform='macOs'])::-webkit-scrollbar-thumb,
body:not([data-platform='macOs'])::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb, var(--border));
  border-radius: var(--scrollbar-radius, 4px);
  border: none;
}

html:not([data-platform='macOs'])::-webkit-scrollbar-track,
body:not([data-platform='macOs'])::-webkit-scrollbar-track {
  background: transparent;
  border-radius: var(--scrollbar-radius, 4px);
  border: none;
  box-shadow: none;
}

html:not([data-platform='macOs'])::-webkit-scrollbar-button,
body:not([data-platform='macOs'])::-webkit-scrollbar-button {
  display: none;
}

/* ============================================================
 * Tailwind CSS v4 主题配置
 * ============================================================ */
@theme {
  /* 布局尺寸变量 - 引用 preferences 的 --admin-* 变量 */
  --spacing-header: var(--admin-header-height, 50px);
  --spacing-sidebar: var(--admin-sidebar-width, 224px);
  --spacing-sidebar-collapsed: var(--admin-sidebar-collapsed-width, 60px);
  --spacing-sidebar-mixed: var(--layout-sidebar-mixed-width, 80px);
  --spacing-tabbar: var(--admin-tabbar-height, 38px);
  --spacing-footer: var(--admin-footer-height, 32px);
  --spacing-panel: var(--layout-panel-width, 280px);
  --spacing-content-compact: var(--layout-content-compact-width, 1200px);

  /* z-index 层级 */
  --z-layout: var(--layout-z-index, 200);
  --z-layout-header: var(--layout-z-index-header, 210);
  --z-layout-sidebar: var(--layout-z-index-sidebar, 220);
  --z-layout-tabbar: var(--layout-z-index-tabbar, 205);
  --z-layout-panel: var(--layout-z-index-panel, 215);
  --z-layout-overlay: var(--layout-z-index-overlay, 250);

  /* 动画时长 */
  --duration-layout-fast: var(--admin-duration-fast, 150ms);
  --duration-layout-normal: var(--admin-duration-normal, 300ms);
  --duration-layout-slow: var(--admin-duration-slow, 500ms);

  /* 动画曲线 */
  --ease-layout: var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
  --ease-layout-in: var(--admin-easing-in, cubic-bezier(0.4, 0, 1, 1));
  --ease-layout-out: var(--admin-easing-out, cubic-bezier(0, 0, 0.2, 1));

  /* 布局颜色 - 继承偏好设置的 CSS 变量 */
  --color-header: var(--header, oklch(1 0 0));
  --color-header-foreground: var(--header-foreground, oklch(0.1 0 0));
  --color-sidebar: var(--sidebar, oklch(0.15 0.02 250));
  --color-sidebar-foreground: var(--sidebar-foreground, oklch(0.95 0 0));
  --color-background: var(--background, oklch(0.98 0 0));
  --color-background-deep: var(--background-deep, oklch(0.96 0.01 250));
  --color-border: var(--border, oklch(0.9 0.01 250));
  --color-primary: var(--primary, oklch(0.55 0.2 250));
}

/* ============================================================
 * CSS 变量默认值
 * @description 布局特有变量，尺寸变量引用 preferences 的 --admin-* 作为源
 * ============================================================ */
:root {
  /* Admin 变量默认值（兼容未引入 preferences 时的默认布局） */
  --admin-header-height: 50px;
  --admin-sidebar-width: 224px;
  --admin-sidebar-collapsed-width: 60px;
  --admin-tabbar-height: 40px;
  --admin-footer-height: 32px;
  --admin-content-padding: 16px;
  --admin-content-padding-top: var(--admin-content-padding);
  --admin-content-padding-bottom: var(--admin-content-padding);
  --admin-content-padding-left: var(--admin-content-padding);
  --admin-content-padding-right: var(--admin-content-padding);

  /* 布局尺寸（layout 特有） */
  --layout-sidebar-mixed-width: 80px;
  --layout-panel-width: 280px;
  --layout-panel-collapse-width: 0px;
  --layout-content-compact-width: 1200px;
  
  /* z-index 层级 */
  --layout-z-index: 200;
  --layout-z-index-header: 210;
  --layout-z-index-sidebar: 220;
  --layout-z-index-tabbar: 205;
  --layout-z-index-panel: 215;
  --layout-z-index-overlay: 250;
  --layout-z-index-fixed: 10;
  
  /* 弹出层尺寸 */
  --popup-max-height: 500px;
}

/* ============================================================
 * Tailwind CSS v4 自定义工具类
 * ============================================================ */
@utility h-header {
  height: var(--admin-header-height);
}

@utility w-sidebar {
  width: var(--admin-sidebar-width);
}

@utility w-sidebar-collapsed {
  width: var(--admin-sidebar-collapsed-width);
}

@utility w-sidebar-mixed {
  width: var(--layout-sidebar-mixed-width);
}

@utility h-tabbar {
  height: var(--admin-tabbar-height);
}

@utility h-footer {
  height: var(--admin-footer-height);
}

@utility w-panel {
  width: var(--layout-panel-width);
}

@utility top-header {
  top: var(--admin-header-height);
}

@utility left-sidebar {
  left: var(--admin-sidebar-width);
}

@utility left-sidebar-collapsed {
  left: var(--admin-sidebar-collapsed-width);
}

@utility z-layout {
  z-index: var(--layout-z-index);
}

@utility z-layout-header {
  z-index: var(--layout-z-index-header);
}

@utility z-layout-sidebar {
  z-index: var(--layout-z-index-sidebar);
}

@utility z-layout-tabbar {
  z-index: var(--layout-z-index-tabbar);
}

@utility z-layout-panel {
  z-index: var(--layout-z-index-panel);
}

@utility z-layout-overlay {
  z-index: var(--layout-z-index-overlay);
}

@utility duration-layout-fast {
  transition-duration: var(--admin-duration-fast, 150ms);
}

@utility duration-layout-normal {
  transition-duration: var(--admin-duration-normal, 300ms);
}

@utility duration-layout-slow {
  transition-duration: var(--admin-duration-slow, 500ms);
}

@utility ease-layout {
  transition-timing-function: var(--ease-layout);
}

@utility transition-layout {
  transition-property: width, height, margin, padding, transform, opacity, left, right, top, bottom;
  transition-duration: var(--admin-duration-normal, 300ms);
  transition-timing-function: var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

@utility p-content {
  padding: var(--admin-content-padding);
}

@utility pt-content {
  padding-top: var(--admin-content-padding-top);
}

@utility pb-content {
  padding-bottom: var(--admin-content-padding-bottom);
}

@utility pl-content {
  padding-left: var(--admin-content-padding-left);
}

@utility pr-content {
  padding-right: var(--admin-content-padding-right);
}

/* ============================================================
 * 组件样式
 * ============================================================ */

/* 布局容器 */
.layout-container {
  @apply relative w-full;
  min-height: 100vh;
  min-height: 100dvh;
  background-color: var(--muted);
}

/* 顶部通栏 + 侧边导航布局 */
.layout-header-sidebar-nav .layout-sidebar,
.layout-mixed-nav .layout-sidebar,
.layout-header-mixed-nav .layout-sidebar {
  top: var(--admin-header-height);
}

.layout-header-sidebar-nav .layout-sidebar__extra,
.layout-mixed-nav .layout-sidebar__extra,
.layout-header-mixed-nav .layout-sidebar__extra {
  top: var(--admin-header-height);
  height: calc(100% - var(--admin-header-height));
}

.layout-header-sidebar-nav .layout-content,
.layout-mixed-nav .layout-content,
.layout-header-mixed-nav .layout-content {
  margin-left: calc(var(--admin-sidebar-width) + var(--layout-panel-offset-left)) !important;
  margin-right: var(--layout-panel-offset-right) !important;
}

.layout-header-sidebar-nav .layout-tabbar,
.layout-mixed-nav .layout-tabbar,
.layout-header-mixed-nav .layout-tabbar {
  left: calc(var(--admin-sidebar-width) + var(--layout-panel-offset-left)) !important;
  right: var(--layout-panel-offset-right) !important;
  width: calc(100% - var(--admin-sidebar-width) - var(--layout-panel-offset-left) - var(--layout-panel-offset-right)) !important;
}

/* 侧边混合导航布局 */
.layout-sidebar-mixed-nav .layout-header {
  left: var(--admin-sidebar-width) !important;
  width: calc(100% - var(--admin-sidebar-width)) !important;
}

.layout-sidebar-mixed-nav .layout-content {
  margin-left: calc(var(--admin-sidebar-width) + var(--layout-panel-offset-left)) !important;
  margin-right: var(--layout-panel-offset-right) !important;
}

.layout-sidebar-mixed-nav .layout-tabbar {
  left: calc(var(--admin-sidebar-width) + var(--layout-panel-offset-left)) !important;
  right: var(--layout-panel-offset-right) !important;
  width: calc(100% - var(--admin-sidebar-width) - var(--layout-panel-offset-left) - var(--layout-panel-offset-right)) !important;
}

.layout-sidebar-mixed-nav .layout-footer {
  margin-left: calc(var(--admin-sidebar-width) + var(--layout-panel-offset-left)) !important;
  margin-right: var(--layout-panel-offset-right) !important;
}

/* 侧边栏 */
.layout-sidebar {
  @apply fixed left-0 top-0 bottom-0;
  z-index: var(--layout-z-index-sidebar);
  transition: width var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)), transform var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) {
  background-color: var(--sidebar-dark);
  color: var(--sidebar-dark-foreground);
}

:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) {
  background-color: var(--sidebar-light);
  color: var(--sidebar-light-foreground);
  border-right: 1px solid var(--sidebar-light-border);
}

:is(.layout-sidebar--hidden, .layout-sidebar[data-hidden="true"]) {
  transform: translateX(-100%);
}

/* 混合侧边栏模式 - 类似常见 admin 布局：主菜单和子菜单面板都是 fixed 定位 */
:is(.layout-sidebar--mixed, .layout-sidebar[data-mixed="true"]) {
  background-color: var(--sidebar-mixed);
  border-right: none;
}

:is(.layout-sidebar--mixed.layout-sidebar--light, .layout-sidebar[data-mixed="true"][data-theme="light"]) {
  background-color: var(--sidebar-mixed-light);
}

:is(.layout-sidebar--mixed, .layout-sidebar[data-mixed="true"]) .layout-sidebar__inner {
  width: 100%;
}

/* 混合侧边栏扩展区域（子菜单面板）- fixed 定位在主菜单右侧 */
.layout-sidebar__extra {
  position: fixed;
  top: 0;
  height: 100%;
  background-color: var(--background, var(--sidebar-dark-foreground));
  border-right: 1px solid var(--border);
  border-left: 1px solid var(--border);
  overflow: hidden;
  pointer-events: none;
  transition: width var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
  z-index: var(--layout-z-index-sidebar, 220);
}

:is(.layout-sidebar__extra--visible, .layout-sidebar__extra[data-visible="true"]) {
  pointer-events: auto;
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .layout-sidebar__extra {
  background-color: var(--sidebar-extra);
  border-right-color: var(--sidebar-dark-border);
  border-left-color: var(--sidebar-dark-border);
}

/* 混合导航时禁用过渡避免闪烁 */
:is(.layout-sidebar--mixed.layout-sidebar--no-transition, .layout-sidebar[data-mixed="true"][data-no-transition="true"]),
:is(.layout-sidebar--mixed.layout-sidebar--no-transition, .layout-sidebar[data-mixed="true"][data-no-transition="true"]) .layout-sidebar__extra {
  transition: none;
}

@media (max-width: 768px) {
  .layout-sidebar {
    transform: translateX(-100%);
  }

  :is(.layout-sidebar--mobile-visible, .layout-sidebar[data-mobile-visible="true"]) {
    transform: translateX(0);
  }
}

/* 顶栏 */
.layout-header {
  @apply fixed top-0 right-0;
  z-index: var(--layout-z-index-header);
  border-bottom: 1px solid var(--border);
  transition: left var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)), transform var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

:is(.layout-header--light, .layout-header[data-theme="light"]) {
  background-color: var(--header-light);
  color: var(--header-light-foreground);
}

:is(.layout-header--dark, .layout-header[data-theme="dark"]) {
  background-color: var(--header-dark);
  color: var(--header-dark-foreground);
  border-color: var(--header-dark-border);
}

:is(.layout-header--hidden, .layout-header[data-hidden="true"]) {
  transform: translateY(calc(-100% - 1px));
  opacity: 0;
  pointer-events: none;
  border-bottom-color: transparent;
  background-color: transparent;
}

@media (max-width: 768px) {
  .layout-header {
    left: 0 !important;
  }
}

/* 顶栏面包屑颜色跟随顶栏主题 */
.layout-header .breadcrumb {
  color: inherit;
}

.layout-header .breadcrumb__item {
  color: color-mix(in oklch, currentColor 70%, transparent);
}

.layout-header .breadcrumb__item:hover,
.layout-header .breadcrumb__item:focus-visible {
  color: currentColor;
}

.layout-header .breadcrumb li:last-child .breadcrumb__item {
  color: currentColor;
}

.layout-header .breadcrumb__separator,
.layout-header .breadcrumb__separator svg {
  color: color-mix(in oklch, currentColor 60%, transparent);
}

/* ============================================================
 * 顶栏菜单启动器模式
 * ============================================================ */
.layout-header__menu-launcher {
  @apply flex items-center;
}

:is(.header-menu--align-start, .layout-header__menu[data-align="start"]) {
  justify-content: flex-start;
}

:is(.header-menu--align-center, .layout-header__menu[data-align="center"]) {
  justify-content: center;
}

:is(.header-menu--align-end, .layout-header__menu[data-align="end"]) {
  justify-content: flex-end;
}

.layout-header__launcher-btn {
  @apply flex items-center gap-2 h-9 px-3 border-0 rounded-md bg-transparent text-sm font-medium cursor-pointer transition-colors;
  color: inherit;
}

.layout-header__launcher-btn:hover {
  background-color: color-mix(in oklch, var(--foreground) 5%, transparent);
}

.dark .layout-header__launcher-btn:hover {
  background-color: color-mix(in oklch, var(--sidebar-dark-foreground) 10%, transparent);
}

.layout-header__launcher-panel {
  animation: launcher-slide-down var(--admin-duration-fast, 150ms) var(--admin-easing-out, ease-out);
}

.layout-header__launcher-overlay {
  position: fixed;
  inset: 0;
  top: var(--admin-header-height);
  z-index: calc(var(--layout-z-index-header) - 1);
  background: color-mix(in oklch, var(--foreground) 6%, transparent);
}

.layout-header__launcher-panel {
  width: 100%;
  max-height: calc(100vh - var(--admin-header-height));
  overflow: auto;
  background-color: var(--background);
  border-bottom: 1px solid var(--border);
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.12);
  padding: 20px 24px 28px;
}

.layout-header__launcher-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 24px;
}

.layout-header__launcher-group {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.layout-header__launcher-title,
.layout-header__launcher-item-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  text-align: left;
  border: 0;
  background: transparent;
  color: inherit;
  cursor: pointer;
  padding: 6px 8px;
  border-radius: 8px;
  font-size: 14px;
  line-height: 1.4;
  transition: background-color 0.2s ease, color 0.2s ease;
}

.layout-header__launcher-title--group {
  font-weight: 600;
  font-size: 15px;
  color: var(--foreground);
  background-color: color-mix(in oklch, var(--foreground) 4%, transparent);
  border: 1px solid color-mix(in oklch, var(--foreground) 8%, transparent);
}

.layout-header__launcher-title.is-single {
  font-weight: 500;
  font-size: 13px;
  color: color-mix(in oklch, var(--foreground) 78%, transparent);
  background-color: transparent;
  border: 1px solid transparent;
}

.layout-header__launcher-title[data-active="true"],
.layout-header__launcher-item-btn[data-active="true"] {
  color: var(--primary);
  background-color: color-mix(in oklch, var(--primary) 12%, transparent);
}

.layout-header__launcher-title:hover,
.layout-header__launcher-item-btn:hover {
  background-color: color-mix(in oklch, var(--foreground) 6%, transparent);
}

.layout-header__launcher-item.is-disabled .layout-header__launcher-item-btn,
.layout-header__launcher-title:disabled,
.layout-header__launcher-item-btn:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

.layout-header__launcher-list,
.layout-header__launcher-sublist {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin: 0;
  padding: 0;
  list-style: none;
}

.layout-header__launcher-sublist {
  margin-left: 14px;
  padding-left: 12px;
  border-left: 1px solid color-mix(in oklch, var(--foreground) 12%, transparent);
}

.layout-header__launcher-item-btn {
  font-size: 13px;
  color: color-mix(in oklch, var(--foreground) 78%, transparent);
}

.layout-header__launcher-sublist .layout-header__launcher-item-btn {
  padding: 4px 8px;
  gap: 6px;
}

.layout-header__launcher-sublist .layout-header__launcher-icon {
  font-size: 14px;
}

.layout-header__launcher-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  line-height: 1;
}

.layout-header__launcher-empty {
  text-align: center;
  color: color-mix(in oklch, var(--foreground) 55%, transparent);
  padding: 32px 0;
  font-size: 14px;
}

@keyframes launcher-slide-down {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* 标签栏 */
.layout-tabbar {
  @apply fixed right-0;
  z-index: var(--layout-z-index-tabbar);
  background-color: var(--background, var(--sidebar-dark-foreground));
  border-bottom: 1px solid var(--border);
  transition:
    left var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    top var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
  will-change: left, top;
}

.layout-tabbar__inner {
  align-items: center;
  gap: 0;
}

.layout-tabbar__tabs {
  height: 100%;
  align-items: stretch;
}

.layout-tabbar__scroll-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 0 0.5rem;
  color: var(--muted-foreground);
  transition: background-color var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    color var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.layout-tabbar__scroll-btn--left {
  border-right: 1px solid var(--border);
}

.layout-tabbar__scroll-btn--right {
  border-left: 1px solid var(--border);
}

.layout-tabbar__scroll-btn:hover {
  background-color: var(--muted);
  color: var(--foreground);
}

.layout-tabbar__scroll-btn[data-disabled="true"] {
  pointer-events: none;
  opacity: 0.3;
}

.layout-tabbar__tool-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 0 0.5rem;
  border-left: 1px solid var(--border);
  color: var(--muted-foreground);
  transition: background-color var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    color var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.layout-tabbar__tool-btn:hover {
  background-color: var(--muted);
  color: var(--foreground);
}

/* 标签栏菜单（右键/更多） */
.layout-tabbar__context-menu,
.layout-tabbar__more-menu {
  background-color: var(--background);
  color: var(--foreground);
  min-width: 160px;
  max-width: 280px;
  white-space: nowrap;
  z-index: calc(var(--layout-z-index-overlay) + 1);
}

.layout-tabbar__more {
  display: flex;
  align-items: center;
  height: 100%;
}

.layout-tabbar__context-menu .layout-tabbar__menu-item,
.layout-tabbar__more-menu .layout-tabbar__menu-item {
  color: var(--foreground);
  justify-content: flex-start;
  white-space: nowrap;
  word-break: keep-all;
}

.layout-tabbar__context-menu .layout-tabbar__menu-item:hover,
.layout-tabbar__more-menu .layout-tabbar__menu-item:hover {
  background-color: color-mix(in oklch, var(--foreground) 6%, transparent);
}

@media (max-width: 768px) {
  .layout-tabbar {
    left: 0 !important;
  }
}

/* 标签样式 */
.layout-tabbar__tab {
  @apply flex items-center cursor-pointer;
  color: var(--accent-foreground);
  content-visibility: auto;
  contain-intrinsic-size: 36px 200px;
  transition: all 300ms ease;
  will-change: transform;
  user-select: none;
}

.layout-tabbar__tab-content {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  height: 100%;
}

.layout-tabbar__tab-extra {
  position: absolute;
  right: 0.375rem;
  top: 50%;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  transform: translateY(-50%);
}

.layout-tabbar__tab-main {
  position: relative;
  z-index: 2;
  display: flex;
  align-items: center;
  height: 100%;
  margin: 0 1rem 0 0.75rem;
  padding-right: 0.75rem;
  overflow: hidden;
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
  color: var(--accent-foreground);
  transition: all 300ms ease;
}

.layout-tabbar__tab-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1rem;
  height: 1rem;
  margin-right: 0.5rem;
}

.layout-tabbar__tab-name {
  font-size: 0.875rem;
  line-height: 1.25rem;
}

.layout-tabbar__tab-close,
.layout-tabbar__tab-pin {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 12px;
  height: 12px;
  border-radius: 9999px;
  cursor: pointer;
  color: color-mix(in oklch, var(--accent-foreground) 80%, transparent);
  transition: background-color 150ms ease, color 150ms ease;
}

.layout-tabbar__tab-pin {
  width: 14px;
  height: 14px;
}

.layout-tabbar__tab-close:hover,
.layout-tabbar__tab-pin:hover {
  background-color: var(--accent);
  color: var(--accent-foreground);
}

.layout-tabbar__tab-close svg {
  width: 12px;
  height: 12px;
}

.layout-tabbar__tab-pin svg {
  width: 14px;
  height: 14px;
}

:is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk) {
  position: relative;
  display: flex;
  align-items: center;
  height: 100%;
  cursor: pointer;
  user-select: none;
  color: var(--accent-foreground);
  transition: all 300ms ease;
}

:is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] {
  background-color: color-mix(in oklch, var(--primary) 15%, transparent);
}

:root.dark :is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] {
  background-color: var(--accent);
}

:is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="inactive"]:hover {
  background-color: var(--accent);
}

:is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] .layout-tabbar__tab-main {
  color: var(--primary);
}

:root.dark :is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] .layout-tabbar__tab-main {
  color: var(--accent-foreground);
}

:is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] .layout-tabbar__tab-close,
:is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] .layout-tabbar__tab-pin {
  color: var(--primary);
}

:root.dark :is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] .layout-tabbar__tab-close,
:root.dark :is(.layout-tabbar__tab--plain, .layout-tabbar__tab--card, .layout-tabbar__tab--brisk)[data-state="active"] .layout-tabbar__tab-pin {
  color: var(--accent-foreground);
}

.layout-tabbar__tab:hover {
  color: var(--accent-foreground);
}

:is(.layout-tabbar__tab--hovered, .layout-tabbar__tab[data-hovered="true"]) {
  color: var(--accent-foreground);
}

:is(.layout-tabbar__tab--active, .layout-tabbar__tab[data-state="active"]) {
  color: var(--primary);
}

:root.dark :is(.layout-tabbar__tab--active, .layout-tabbar__tab[data-state="active"]) {
  color: var(--accent-foreground);
}

:root.dark :is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]):is(.layout-tabbar__tab--active, .layout-tabbar__tab[data-state="active"]) {
  color: var(--accent-foreground);
}

/* Chrome 风格标签 */
:is(.layout-tabbar--chrome, .layout-tabbar[data-style="chrome"]) {
  --tab-chrome-gap: 7px;
  --tab-chrome-overlap: 10px;
}

:is(.layout-tabbar--chrome, .layout-tabbar[data-style="chrome"]) .layout-tabbar__inner {
  gap: 0;
}

:is(.layout-tabbar--chrome, .layout-tabbar[data-style="chrome"]) .layout-tabbar__tabs {
  overflow-y: hidden;
  padding-top: 3px;
  padding-right: 1.5rem;
}


:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]) {
  position: relative;
  height: 100%;
  padding: 0;
  margin-right: calc(var(--tab-chrome-overlap) * -1);
  background-color: transparent;
  isolation: isolate;
}

.layout-tabbar__chrome {
  position: relative;
  width: 100%;
  height: 100%;
  padding: 0 4px;
}

.layout-tabbar__chrome-divider {
  position: absolute;
  left: var(--tab-chrome-gap);
  top: 50%;
  z-index: 0;
  width: 1px;
  height: 16px;
  transform: translateY(-50%);
  background-color: var(--border);
  opacity: 1;
  transition: opacity var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-index="0"] .layout-tabbar__chrome-divider {
  opacity: 0;
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]):hover .layout-tabbar__chrome-divider,
:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] .layout-tabbar__chrome-divider {
  opacity: 0;
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]):not([data-state="active"]):hover + :is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]) .layout-tabbar__chrome-divider {
  opacity: 0;
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] + :is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]) .layout-tabbar__chrome-divider {
  opacity: 0 !important;
}

.layout-tabbar__chrome-bg {
  position: absolute;
  inset: 0;
  z-index: -1;
  padding: 0 calc(var(--tab-chrome-gap) - 1px);
  transition: padding-bottom var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]):not([data-state="active"]):hover .layout-tabbar__chrome-bg {
  padding-bottom: 2px;
}

.layout-tabbar__chrome-bg-content {
  height: 100%;
  border-top-left-radius: var(--tab-chrome-gap);
  border-top-right-radius: var(--tab-chrome-gap);
  background-color: transparent;
  transition: all var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]):not([data-state="active"]):hover .layout-tabbar__chrome-bg-content {
  margin: 0 2px;
  border-radius: 0.375rem;
  background-color: var(--accent);
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] .layout-tabbar__chrome-bg-content {
  background-color: color-mix(in oklch, var(--primary) 15%, transparent);
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] {
  z-index: 2;
}

:root.dark :is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] .layout-tabbar__chrome-bg-content {
  background-color: var(--accent);
}

.layout-tabbar__chrome-bg-before,
.layout-tabbar__chrome-bg-after {
  position: absolute;
  bottom: 0;
  width: 7px;
  height: 7px;
  fill: transparent;
  transition: fill var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.layout-tabbar__chrome-bg-before {
  left: -1px;
}

.layout-tabbar__chrome-bg-after {
  right: -1px;
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] .layout-tabbar__chrome-bg-before,
:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] .layout-tabbar__chrome-bg-after {
  fill: color-mix(in oklch, var(--primary) 15%, transparent);
}

:root.dark :is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] .layout-tabbar__chrome-bg-before,
:root.dark :is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"])[data-state="active"] .layout-tabbar__chrome-bg-after {
  fill: var(--accent);
}

.layout-tabbar__chrome-main {
  position: relative;
  z-index: 2;
  display: flex;
  align-items: center;
  height: 100%;
  margin: 0 calc(var(--tab-chrome-gap) * 2);
  padding: 0 1rem 0 0.5rem;
  overflow: hidden;
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
  color: inherit;
}

.layout-tabbar__chrome-extra {
  position: absolute;
  right: calc(var(--tab-chrome-gap) + 6px);
  top: 50%;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  transform: translateY(-50%);
}

.layout-tabbar__chrome-extra .layout-tabbar__tab-close {
  margin-top: 2px;
}

.layout-tabbar__chrome-extra .layout-tabbar__tab-pin {
  margin-top: 1px;
}

:is(.layout-tabbar__tab--chrome, .layout-tabbar__tab[data-style="chrome"]) .layout-tabbar__tab-icon {
  margin-right: 0.25rem;
}

/* Plain 风格标签 */
:is(.layout-tabbar__tab--plain, .layout-tabbar__tab[data-style="plain"]) {
  height: 100%;
}

:is(.layout-tabbar__tab--plain, .layout-tabbar__tab[data-style="plain"]):not([data-index="0"]) {
  border-left: 1px solid var(--border);
}

:is(.layout-tabbar__tab--plain, .layout-tabbar__tab[data-style="plain"]):last-child {
  border-right: 1px solid var(--border);
}

/* Card 风格标签 */
:is(.layout-tabbar__tab--card, .layout-tabbar__tab[data-style="card"]) {
  height: calc(100% - 6px);
  margin-top: 3px;
  margin-bottom: 3px;
  margin-left: 0.5rem;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
}

/* Brisk 风格标签 */
:is(.layout-tabbar__tab--brisk, .layout-tabbar__tab[data-style="brisk"]) {
  height: 100%;
}

:is(.layout-tabbar__tab--brisk, .layout-tabbar__tab[data-style="brisk"])::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: 0;
  width: 100%;
  height: 1.5px;
  background-color: var(--primary);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 300ms ease;
}

:is(.layout-tabbar__tab--brisk, .layout-tabbar__tab[data-style="brisk"]):hover::after,
:is(.layout-tabbar__tab--brisk, .layout-tabbar__tab[data-style="brisk"])[data-state="active"]::after {
  transform: scaleX(1);
}

:is(.layout-tabbar__tab--brisk, .layout-tabbar__tab[data-style="brisk"]):not([data-index="0"]) {
  border-left: 1px solid var(--border);
}

:is(.layout-tabbar__tab--brisk, .layout-tabbar__tab[data-style="brisk"]):last-child {
  border-right: 1px solid var(--border);
}

/* ============================================================
 * 标签栏拖拽排序样式
 * ============================================================ */
.layout-tabbar__tabs[data-dragging="true"] {
  cursor: grabbing;
}

:is(.layout-tabbar__tab--dragging, .layout-tabbar__tab[data-dragging="true"]) {
  opacity: 0.5;
  transform: scale(0.98);
  cursor: grabbing;
}

:is(.layout-tabbar__tab--drop-target, .layout-tabbar__tab[data-drop-target="true"]) {
  position: relative;
}

:is(.layout-tabbar__tab--drop-target, .layout-tabbar__tab[data-drop-target="true"])::before {
  content: '';
  position: absolute;
  left: -2px;
  top: 20%;
  width: 3px;
  height: 60%;
  background-color: var(--primary);
  border-radius: 2px;
  animation: drop-indicator var(--admin-duration-normal, 300ms) var(--admin-easing-default, ease);
}

@keyframes drop-indicator {
  from {
    opacity: 0;
    transform: scaleY(0);
  }
  to {
    opacity: 1;
    transform: scaleY(1);
  }
}

/* 固定标签不可拖拽 */
:is(.layout-tabbar__tab--affix, .layout-tabbar__tab[data-affix="true"])[draggable="true"] {
  cursor: default;
}

/* ============================================================
 * 内容区最大化样式
 * ============================================================ */
:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-sidebar {
  transform: translateX(-100%);
  opacity: 0;
  pointer-events: none;
}

:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-header {
  opacity: 0;
  pointer-events: none;
}

:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-tabbar {
  left: 0 !important;
  top: 0 !important;
}

:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-content {
  margin-left: 0 !important;
  margin-top: var(--admin-tabbar-height, 38px) !important;
}

:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-footer {
  left: 0 !important;
  margin-left: 0 !important;
}

:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-panel {
  top: var(--admin-tabbar-height, 38px) !important;
}

/* 最大化过渡动画 */
:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-sidebar,
:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-header,
:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-tabbar,
:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-content,
:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-footer,
:is(body.layout-content-maximized, body[data-content-maximized="true"]) .layout-panel {
  transition: all var(--admin-duration-normal, 300ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

/* 内容区 */
.layout-content {
  @apply relative;
  min-height: 100vh;
  min-height: 100dvh;
  background-color: var(--background, var(--sidebar-dark-foreground));
  transition: margin var(--admin-duration-fast, 150ms)
    var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

@media (max-width: 768px) {
  .layout-content {
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
}

/* 页脚 */
.layout-footer {
  @apply relative;
  z-index: var(--layout-z-index);
  background-color: var(--background, var(--sidebar-dark-foreground));
  border-top: 1px solid var(--border);
  transition: margin var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)), left var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

:is(.layout-footer--fixed, .layout-footer[data-fixed="true"]) {
  position: fixed;
  bottom: 0;
  right: 0;
}

@media (max-width: 768px) {
  .layout-footer {
    margin-left: 0 !important;
    left: 0 !important;
  }
}

/* 功能区 */
.layout-panel {
  @apply fixed bottom-0;
  z-index: var(--layout-z-index-panel);
  background-color: var(--background, var(--sidebar-dark-foreground));
  will-change: left, right, width;
  transition: width var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    left var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    right var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.layout-scroll-container {
  content-visibility: auto;
  contain-intrinsic-size: 600px 800px;
}

.layout-list-item {
  content-visibility: auto;
  contain-intrinsic-size: 44px 320px;
}

:is(.layout-panel--left, .layout-panel[data-position="left"]) {
  left: 0;
  border-right: 1px solid var(--border);
}

:is(.layout-panel--right, .layout-panel[data-position="right"]) {
  right: 0;
  border-left: 1px solid var(--border);
}

:is(.layout-panel--collapsed, .layout-panel[data-collapsed="true"]) .layout-panel__content,
:is(.layout-panel--collapsed, .layout-panel[data-collapsed="true"]) .layout-panel__header span,
:is(.layout-panel--collapsed, .layout-panel[data-collapsed="true"]) .layout-panel__footer {
  display: none;
}

/* 遮罩层 */
.layout-overlay {
  @apply fixed inset-0;
  z-index: var(--layout-z-index-overlay);
  background-color: color-mix(in oklch, var(--foreground) 50%, transparent);
  transition: opacity var(--admin-duration-fast, 150ms);
  opacity: 0;
  pointer-events: none;
}

:is(.layout-overlay--visible, .layout-overlay[data-state="visible"]) {
  opacity: 1;
  pointer-events: auto;
}

/* ============================================================
 * 颜色工具类
 * ============================================================ */
.bg-header {
  background-color: var(--header, var(--sidebar-dark-foreground));
}

.bg-sidebar {
  background-color: var(--sidebar-dark);
}

.bg-background {
  background-color: var(--background, var(--sidebar-dark-foreground));
}

.bg-background-deep {
  background-color: var(--muted);
}

.text-header-foreground {
  color: var(--header-foreground, var(--sidebar-light-foreground));
}

.text-sidebar-foreground {
  color: var(--sidebar-foreground, var(--sidebar-dark-foreground));
}

.border-border {
  border-color: var(--border);
}

.text-primary {
  color: var(--primary);
}

.bg-primary {
  background-color: var(--primary);
}

.border-primary {
  border-color: var(--primary);
}

.hover\:text-primary:hover {
  color: var(--primary);
}

/* ============================================================
 * 灰色模式 & 色弱模式
 * @note 这些类已在 @admin-core/preferences 的 utilities.css 中定义为 @utility
 *       此处保留空注释作为向后兼容的提示，实际样式由 preferences 提供
 * ============================================================ */

/* ============================================================
 * 偏好设置按钮
 * ============================================================ */
.layout-preferences-button {
  @apply fixed right-0 top-1/2 flex items-center justify-center;
  transform: translateY(-50%);
  z-index: var(--layout-z-index-overlay, 250);
  width: 48px;
  height: 48px;
  border: none;
  border-radius: 8px 0 0 8px;
  background-color: var(--primary);
  color: var(--primary-foreground);
  cursor: pointer;
  box-shadow: none;
  transition: all var(--admin-duration-fast, 150ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.layout-preferences-button:hover {
  width: 52px;
  background-color: var(--primary-600);
}

.layout-preferences-button:active {
  transform: translateY(-50%) scale(0.95);
}

.layout-preferences-button svg {
  animation: layout-preferences-spin 8s linear infinite;
}

.layout-preferences-button--floating {
  right: auto;
  top: auto;
  transform: none;
  border-radius: 999px;
  touch-action: none;
}

.layout-preferences-button--floating:hover {
  width: 48px;
}

.layout-preferences-button--floating:active {
  transform: scale(0.95);
}

.layout-preferences-button--dragging {
  transition: none !important;
}

.layout-preferences-button--floating[data-edge="left"] {
  border-radius: 0 8px 8px 0;
}

.layout-preferences-button--floating[data-edge="right"] {
  border-radius: 8px 0 0 8px;
}

.layout-preferences-button--floating[data-edge="top"] {
  border-radius: 0 0 8px 8px;
}

.layout-preferences-button--floating[data-edge="bottom"] {
  border-radius: 8px 8px 0 0;
}

@keyframes layout-preferences-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: reduce) {
  .layout-container,
  .layout-header,
  .layout-sidebar,
  .layout-tabbar,
  .layout-content,
  .layout-footer,
  .layout-panel,
  .layout-overlay,
  .sidebar-menu,
  .sidebar-menu__submenu {
    transition: none !important;
    animation: none !important;
  }

  .layout-preferences-button svg {
    animation: none !important;
  }
}

/* ========================================
   侧边栏菜单样式
   ======================================== */

.sidebar-menu {
  padding: 0.5rem;
  content-visibility: auto;
  contain-intrinsic-size: 600px 800px;
}

.sidebar-menu__item {
  @apply flex items-center cursor-pointer select-none text-sm;
  padding: 0.625rem 0.75rem;
  margin: 0.125rem 0;
  border-radius: 0.375rem;
  color: var(--sidebar-dark-muted);
  transition: all var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
  line-height: 1.25rem;
  content-visibility: auto;
  contain-intrinsic-size: 48px 240px;
}

.sidebar-menu__item:hover {
  background-color: var(--sidebar-dark-hover);
  color: var(--sidebar-dark-foreground);
}

:is(.sidebar-menu__item--active, .sidebar-menu__item[data-state="active"]) {
  background-color: var(--primary) !important;
  color: var(--primary-foreground) !important;
}

:is(.sidebar-menu__item--has-active-child, .sidebar-menu__item[data-has-active-child="true"]) {
  color: var(--sidebar-dark-foreground);
}

:is(.sidebar-menu__item--disabled, .sidebar-menu__item[data-disabled="true"]) {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

.sidebar-menu__icon {
  @apply flex items-center justify-center shrink-0;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: 0.75rem;
  font-size: 1rem;
}

.sidebar-menu__icon svg {
  width: 1.125rem;
  height: 1.125rem;
}

.sidebar-menu__name {
  @apply flex-1 truncate;
}

.sidebar-menu__arrow {
  @apply flex items-center ml-2 shrink-0 transition-transform;
}

.sidebar-menu__arrow svg {
  width: 1rem;
  height: 1rem;
}

:is(.sidebar-menu__arrow--expanded, .sidebar-menu__arrow[data-expanded="true"]) {
  transform: rotate(90deg);
}

.sidebar-menu__submenu {
  margin-left: 0.75rem;
  border-left: 1px solid color-mix(in oklch, var(--sidebar-dark-foreground) 10%, transparent);
  padding-left: 0.5rem;
  content-visibility: auto;
  contain-intrinsic-size: 400px 600px;
}

/* 层级缩进 */
:is(.sidebar-menu__item--level-1, .sidebar-menu__item[data-level="1"]) {
  padding-left: 1rem;
}

:is(.sidebar-menu__item--level-2, .sidebar-menu__item[data-level="2"]) {
  padding-left: 1.25rem;
}

:is(.sidebar-menu__item--level-3, .sidebar-menu__item[data-level="3"]) {
  padding-left: 1.5rem;
}

:is(.sidebar-menu__item--level-4, .sidebar-menu__item[data-level="4"]) {
  padding-left: 1.75rem;
}

/* 浅色主题 */
:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) .sidebar-menu__item {
  color: var(--muted-foreground);
}

:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) .sidebar-menu__item:hover {
  background-color: color-mix(in oklch, var(--foreground) 5%, transparent);
  color: var(--sidebar-light-foreground);
}

:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) :is(.sidebar-menu__item--has-active-child, .sidebar-menu__item[data-has-active-child="true"]) {
  color: var(--sidebar-light-foreground);
}

:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) .sidebar-menu__submenu {
  border-color: color-mix(in oklch, var(--foreground) 10%, transparent);
}

/* 折叠状态下的菜单 tooltip */
.sidebar-menu__tooltip {
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translateY(-50%) scale(0.95);
  margin-left: 0.5rem;
  padding: var(--tooltip-padding-y, 0.5rem) var(--tooltip-padding-x, 1rem);
  background-color: var(--tooltip-bg, var(--sidebar-light-foreground));
  color: var(--tooltip-fg, var(--sidebar-dark-foreground));
  font-size: var(--tooltip-font-size, 0.75rem);
  border-radius: var(--tooltip-radius, 0.375rem);
  border: 1px solid var(--tooltip-border, color-mix(in oklch, var(--foreground) 12%, transparent));
  white-space: nowrap;
  z-index: var(--admin-z-index-tooltip, 1070);
  box-shadow: var(--tooltip-shadow, 0 8px 24px -12px color-mix(in oklch, var(--foreground) 25%, transparent));
  opacity: 0;
  visibility: hidden;
  transition:
    opacity var(--tooltip-enter-duration, var(--admin-duration-fast, 150ms)) var(--tooltip-ease, ease),
    transform var(--tooltip-enter-duration, var(--admin-duration-fast, 150ms)) var(--tooltip-ease, ease),
    visibility var(--tooltip-enter-duration, var(--admin-duration-fast, 150ms)) var(--tooltip-ease, ease);
}

.sidebar-menu__tooltip::before {
  content: '';
  position: absolute;
  left: -4px;
  top: 50%;
  transform: translateY(-50%) rotate(45deg);
  width: var(--tooltip-arrow-size, 8px);
  height: var(--tooltip-arrow-size, 8px);
  border-radius: calc(var(--tooltip-radius, 0.375rem) - 2px);
  background: var(--tooltip-bg, var(--sidebar-light-foreground));
  border: 1px solid var(--tooltip-border, color-mix(in oklch, var(--foreground) 12%, transparent));
}

.sidebar-menu__item:hover .sidebar-menu__tooltip {
  opacity: 1;
  visibility: visible;
  transform: translateY(-50%) scale(1);
}

/* 折叠状态下右侧小箭头 */
.sidebar-menu__arrow-right {
  position: absolute;
  right: 0.25rem;
  top: 50%;
  transform: translateY(-50%);
  color: inherit;
  opacity: 0.5;
}

/* ========================================
   折叠状态弹出子菜单样式（类似常见 admin 布局）
   ======================================== */
.sidebar-menu__popup {
  position: fixed;
  z-index: var(--admin-z-index-popover, 1060);
  min-width: 180px;
  max-width: 240px;
  max-height: 70vh;
  overflow-y: auto;
  content-visibility: auto;
  contain-intrinsic-size: 400px 600px;
  background-color: var(--sidebar-bg, var(--sidebar-light-foreground));
  border-radius: 0.5rem;
  box-shadow: 0 10px 40px color-mix(in oklch, var(--foreground) 30%, transparent);
  padding: 0.5rem 0;
  animation: popup-fade-in var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
}

@keyframes popup-fade-in {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.sidebar-menu__popup-title {
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  font-weight: 600;
  color: color-mix(in oklch, var(--sidebar-dark-foreground) 90%, transparent);
  border-bottom: 1px solid color-mix(in oklch, var(--sidebar-dark-foreground) 10%, transparent);
  margin-bottom: 0.25rem;
}

.sidebar-menu__popup-content {
  padding: 0.25rem 0;
  content-visibility: auto;
  contain-intrinsic-size: 400px 600px;
}

.sidebar-menu__popup-group {
  /* 子菜单分组 */
}

.sidebar-menu__popup-item {
  @apply flex items-center gap-2 cursor-pointer relative;
  padding: 0.625rem 1rem;
  color: color-mix(in oklch, var(--sidebar-dark-foreground) 70%, transparent);
  transition: background var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease), color var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
  content-visibility: auto;
  contain-intrinsic-size: 44px 240px;
}

.sidebar-menu__popup-item:hover {
  background-color: color-mix(in oklch, var(--sidebar-dark-foreground) 8%, transparent);
  color: var(--sidebar-dark-foreground);
}

:is(.sidebar-menu__popup-item--active, .sidebar-menu__popup-item[data-state="active"]) {
  background-color: var(--primary) !important;
  color: var(--sidebar-dark-foreground) !important;
}

:is(.sidebar-menu__popup-item--has-active-child, .sidebar-menu__popup-item[data-has-active-child="true"]) {
  color: var(--primary);
}

:is(.sidebar-menu__popup-item--disabled, .sidebar-menu__popup-item[data-disabled="true"]) {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

:is(.sidebar-menu__popup-item--level-1, .sidebar-menu__popup-item[data-level="1"]) {
  padding-left: 1.5rem;
}

:is(.sidebar-menu__popup-item--level-2, .sidebar-menu__popup-item[data-level="2"]) {
  padding-left: 2rem;
}

.sidebar-menu__popup-icon {
  @apply flex items-center justify-center shrink-0;
  width: 1rem;
  height: 1rem;
}

.sidebar-menu__popup-name {
  @apply flex-1 text-sm truncate;
}

.sidebar-menu__popup-arrow {
  @apply shrink-0 transition-transform;
}

:is(.sidebar-menu__popup-arrow--expanded, .sidebar-menu__popup-arrow[data-expanded="true"]) {
  transform: rotate(90deg);
}

.sidebar-menu__popup-submenu {
  /* 嵌套子菜单 */
}

/* 深色主题弹出菜单（默认） */
:is(.sidebar-menu__popup--dark, .sidebar-menu__popup[data-theme="dark"]) {
  background-color: var(--sidebar-bg, var(--sidebar-light-foreground));
  box-shadow: 0 10px 40px color-mix(in oklch, var(--foreground) 30%, transparent);
}

:is(.sidebar-menu__popup--dark, .sidebar-menu__popup[data-theme="dark"]) .sidebar-menu__popup-title {
  color: color-mix(in oklch, var(--sidebar-dark-foreground) 90%, transparent);
  border-bottom-color: color-mix(in oklch, var(--sidebar-dark-foreground) 10%, transparent);
}

:is(.sidebar-menu__popup--dark, .sidebar-menu__popup[data-theme="dark"]) .sidebar-menu__popup-item {
  color: color-mix(in oklch, var(--sidebar-dark-foreground) 70%, transparent);
}

:is(.sidebar-menu__popup--dark, .sidebar-menu__popup[data-theme="dark"]) .sidebar-menu__popup-item:hover {
  background-color: color-mix(in oklch, var(--sidebar-dark-foreground) 8%, transparent);
  color: var(--sidebar-dark-foreground);
}

:is(.sidebar-menu__popup--dark, .sidebar-menu__popup[data-theme="dark"]) :is(.sidebar-menu__popup-item--active, .sidebar-menu__popup-item[data-state="active"]) {
  background-color: var(--primary) !important;
  color: var(--sidebar-dark-foreground) !important;
}

:is(.sidebar-menu__popup--dark, .sidebar-menu__popup[data-theme="dark"]) :is(.sidebar-menu__popup-item--has-active-child, .sidebar-menu__popup-item[data-has-active-child="true"]) {
  color: var(--primary);
}

/* 浅色主题弹出菜单 */
:is(.sidebar-menu__popup--light, .sidebar-menu__popup[data-theme="light"]) {
  background-color: var(--sidebar-dark-foreground);
  box-shadow: 0 10px 40px color-mix(in oklch, var(--foreground) 15%, transparent);
}

:is(.sidebar-menu__popup--light, .sidebar-menu__popup[data-theme="light"]) .sidebar-menu__popup-title {
  color: var(--sidebar-light-foreground);
  border-bottom-color: color-mix(in oklch, var(--foreground) 10%, transparent);
}

:is(.sidebar-menu__popup--light, .sidebar-menu__popup[data-theme="light"]) .sidebar-menu__popup-item {
  color: var(--muted-foreground);
}

:is(.sidebar-menu__popup--light, .sidebar-menu__popup[data-theme="light"]) .sidebar-menu__popup-item:hover {
  background-color: color-mix(in oklch, var(--foreground) 5%, transparent);
  color: var(--sidebar-light-foreground);
}

:is(.sidebar-menu__popup--light, .sidebar-menu__popup[data-theme="light"]) :is(.sidebar-menu__popup-item--active, .sidebar-menu__popup-item[data-state="active"]) {
  background-color: var(--primary) !important;
  color: var(--sidebar-dark-foreground) !important;
}

:is(.sidebar-menu__popup--light, .sidebar-menu__popup[data-theme="light"]) :is(.sidebar-menu__popup-item--has-active-child, .sidebar-menu__popup-item[data-has-active-child="true"]) {
  color: var(--primary);
}

/* 折叠状态菜单 */
:is(.layout-sidebar--collapsed, .layout-sidebar[data-collapsed="true"]) .sidebar-menu__item {
  justify-content: center;
  padding: 0.75rem;
}

:is(.layout-sidebar--collapsed, .layout-sidebar[data-collapsed="true"]) .sidebar-menu__icon {
  margin-right: 0;
}

:is(.layout-sidebar--collapsed, .layout-sidebar[data-collapsed="true"]) .sidebar-menu__arrow {
  display: none;
}

:is(.layout-sidebar--collapsed, .layout-sidebar[data-collapsed="true"]) .sidebar-menu__arrow-right {
  display: none;
}

:is(.layout-sidebar--collapsed, .layout-sidebar[data-collapsed="true"]) .sidebar-menu__submenu {
  display: none;
}

/* 菜单动画 */
.sidebar-menu__submenu-enter {
  opacity: 0;
  max-height: 0;
  overflow: hidden;
}

.sidebar-menu__submenu-enter-active {
  opacity: 1;
  max-height: var(--popup-max-height);
  transition: opacity var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease), max-height var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
}

.sidebar-menu__submenu-exit {
  opacity: 1;
  max-height: var(--popup-max-height);
}

.sidebar-menu__submenu-exit-active {
  opacity: 0;
  max-height: 0;
  overflow: hidden;
  transition: opacity var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease), max-height var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
}

/* ============================================================
 * 菜单组件样式系统（参考常见 admin 布局）
 * ============================================================ */

/* 菜单 CSS 变量 */
:root {
  /* 菜单基础变量 - 参考常见 admin 布局更紧凑的设计 */
  --menu-item-height: 36px;
  --menu-item-padding-x: 10px;
  --menu-item-padding-y: 0;
  --menu-item-margin-x: 1px;
  --menu-item-margin-y: 0;
  --menu-item-radius: 6px;
  --menu-font-size: 0.875rem;
  --menu-icon-size: 1rem;
  --menu-indent: 16px;
  --menu-arrow-size: 14px;
  
  /* 浅色主题颜色变量 - 参考常见 admin 布局的配色 */
  --menu-bg: transparent;
  --menu-item-color: var(--foreground);
  --menu-item-hover-color: var(--primary);
  --menu-item-hover-bg: hsl(var(--accent));
  --menu-item-active-color: var(--primary);
  --menu-item-active-bg: hsl(var(--primary) / 0.15);
  
  /* 弹出层变量 */
  --menu-popup-bg: var(--background);
  --menu-popup-border: var(--border);
  --menu-popup-shadow: 0 10px 40px hsl(var(--foreground) / 0.12);
  --menu-popup-radius: 8px;
  --menu-popup-padding: 8px;
  --menu-popup-min-width: 180px;
  --menu-popup-max-width: 240px;
}

/* ============================================================
 * 顶栏菜单容器
 * ============================================================ */
.header-menu-container {
  @apply flex items-center h-full min-w-0 overflow-hidden;
}

:is(.header-menu-container--align-start, .header-menu-container[data-align="start"]) {
  justify-content: flex-start;
}

:is(.header-menu-container--align-center, .header-menu-container[data-align="center"]) {
  justify-content: center;
}

:is(.header-menu-container--align-end, .header-menu-container[data-align="end"]) {
  justify-content: flex-end;
}

/* ============================================================
 * 菜单基础样式
 * ============================================================ */
.menu {
  @apply flex flex-nowrap items-center h-full p-0 m-0 list-none;
  background: var(--menu-bg);
}

/* 水平模式 */
:is(.menu--horizontal, .menu[data-mode="horizontal"]) {
  @apply flex-row max-w-full min-w-0 overflow-hidden;
}

/* 垂直模式 */
:is(.menu--vertical, .menu[data-mode="vertical"]) {
  @apply flex-col w-full h-auto;
  content-visibility: auto;
  contain-intrinsic-size: 600px 800px;
}

/* 圆角样式 */
:is(.menu--rounded, .menu[data-rounded="true"]) .menu__item,
:is(.menu--rounded, .menu[data-rounded="true"]) .menu__sub-menu-content,
.menu__popup-list[data-rounded="true"] .menu__item,
.menu__popup-list[data-rounded="true"] .menu__sub-menu-content {
  border-radius: var(--menu-item-radius);
}

/* ============================================================
 * 浅色主题
 * ============================================================ */
:is(.menu--light, .menu[data-theme="light"]) {
  --menu-item-color: var(--foreground);
  --menu-item-hover-color: var(--primary);
  --menu-item-hover-bg: hsl(var(--accent));
  --menu-item-active-color: var(--primary);
  --menu-item-active-bg: hsl(var(--primary) / 0.12);
}

/* ============================================================
 * 深色主题
 * ============================================================ */
:is(.menu--dark, .menu[data-theme="dark"]) {
  --menu-item-color: hsl(var(--foreground) / 0.8);
  --menu-item-hover-color: hsl(var(--accent-foreground));
  --menu-item-hover-bg: hsl(var(--accent));
  --menu-item-active-color: hsl(var(--accent-foreground));
  --menu-item-active-bg: hsl(var(--accent));
}

/* ============================================================
 * 菜单项样式
 * ============================================================ */
.menu__item {
  @apply relative inline-flex items-center whitespace-nowrap cursor-pointer bg-transparent border-0 shrink-0;
  height: var(--menu-item-height);
  padding: var(--menu-item-padding-y) var(--menu-item-padding-x);
  margin: var(--menu-item-margin-y) var(--menu-item-margin-x);
  color: var(--menu-item-color);
  font-size: var(--menu-font-size);
  transition: color var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease), background-color var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
  content-visibility: auto;
  contain-intrinsic-size: 40px 200px;
}

.menu__item:hover {
  color: var(--menu-item-hover-color);
  background-color: var(--menu-item-hover-bg);
}

:is(.menu__item--active, .menu__item[data-state="active"]) {
  color: var(--menu-item-active-color);
  background-color: var(--menu-item-active-bg);
}

:is(.menu__item--disabled, .menu__item[data-disabled="true"]) {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/* ============================================================
 * 子菜单样式
 * ============================================================ */
.menu__sub-menu {
  @apply relative inline-flex shrink-0 list-none;
}

.menu__sub-menu-content {
  @apply inline-flex items-center whitespace-nowrap cursor-pointer;
  height: var(--menu-item-height);
  padding: var(--menu-item-padding-y) var(--menu-item-padding-x);
  padding-right: calc(var(--menu-item-padding-x) + 20px);
  margin: var(--menu-item-margin-y) var(--menu-item-margin-x);
  color: var(--menu-item-color);
  font-size: var(--menu-font-size);
  background: transparent;
  transition: color var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease), background-color var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
  content-visibility: auto;
  contain-intrinsic-size: 40px 200px;
}

.menu__sub-menu-content:hover {
  color: var(--menu-item-hover-color);
  background-color: var(--menu-item-hover-bg);
}

:is(.menu__sub-menu--active, .menu__sub-menu[data-state="active"]) > .menu__sub-menu-content {
  color: var(--menu-item-active-color);
  background-color: var(--menu-item-active-bg);
}

:is(.menu__sub-menu--opened, .menu__sub-menu[data-opened="true"]) > .menu__sub-menu-content {
  color: var(--menu-item-hover-color);
  background-color: var(--menu-item-hover-bg);
}

/* 禁用子菜单 */
:is(.menu__sub-menu--disabled, .menu__sub-menu[data-disabled="true"]) > .menu__sub-menu-content {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/* 更多按钮 */
:is(.menu__sub-menu--more, .menu__sub-menu[data-more="true"]) .menu__sub-menu-content {
  padding-right: var(--menu-item-padding-x);
}

.menu__more-icon {
  @apply flex items-center justify-center;
}

/* ============================================================
 * 菜单图标
 * ============================================================ */
.menu__icon {
  @apply flex items-center justify-center shrink-0 transition-transform;
  width: var(--menu-icon-size);
  height: var(--menu-icon-size);
  margin-right: 8px;
}

.menu__icon svg {
  width: 100%;
  height: 100%;
}

.menu__item:hover .menu__icon,
.menu__sub-menu-content:hover .menu__icon {
  transform: scale(1.2);
}

/* ============================================================
 * 菜单名称
 * ============================================================ */
.menu__name {
  max-width: 140px;
  @apply truncate;
}

/* ============================================================
 * 下拉箭头 - 参考常见 admin 布局更小更精致
 * ============================================================ */
.menu__arrow {
  @apply absolute right-2.5 flex items-center justify-center opacity-60;
  transition: transform 250ms ease, opacity 150ms ease;
}

.menu__arrow svg {
  width: var(--menu-arrow-size, 14px);
  height: var(--menu-arrow-size, 14px);
}

.menu__sub-menu-content:hover .menu__arrow {
  opacity: 1;
}

:is(.menu__sub-menu--opened, .menu__sub-menu[data-opened="true"]) > .menu__sub-menu-content > .menu__arrow {
  transform: rotate(180deg);
  opacity: 1;
}

/* ============================================================
 * 弹出层样式
 * ============================================================ */
.menu__popup {
  @apply absolute;
  min-width: var(--menu-popup-min-width);
  max-width: var(--menu-popup-max-width);
  max-height: 70vh;
  overflow-y: auto;
  content-visibility: auto;
  contain-intrinsic-size: 400px 600px;
  padding: var(--menu-popup-padding);
  background-color: var(--menu-popup-bg);
  border: 1px solid var(--menu-popup-border);
  border-radius: var(--menu-popup-radius);
  box-shadow: var(--menu-popup-shadow);
  z-index: var(--admin-z-index-dropdown, 1000);
  --menu-popup-enter-x: 0px;
  --menu-popup-enter-y: -4px;
}

.menu__popup--level-1,
.menu__popup[data-level="1"],
.menu__popup--level-2,
.menu__popup[data-level="2"] {
  --menu-popup-enter-x: -4px;
  --menu-popup-enter-y: 0px;
}

.menu__popup--slow {
  transition:
    opacity var(--admin-duration-slow, 500ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    transform var(--admin-duration-slow, 500ms) var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.menu__popup--slow[data-state="open"] {
  opacity: 1;
  transform: translate(0, 0);
}

.menu__popup--slow[data-state="closed"] {
  opacity: 0;
  transform: translate(var(--menu-popup-enter-x), var(--menu-popup-enter-y));
  pointer-events: none;
}

@media (prefers-reduced-motion: reduce) {
  .menu__popup--slow {
    transition: none;
  }
}

.menu__popup-list {
  @apply flex flex-col p-0 m-0 list-none;
  content-visibility: auto;
  contain-intrinsic-size: 400px 600px;
}

/* 弹出层中的菜单项 */
.menu__popup .menu__item {
  @apply flex;
  height: auto;
  padding: 8px 12px;
  margin: 2px 0;
}

.menu__popup .menu__sub-menu {
  @apply flex flex-col;
}

.menu__popup .menu__sub-menu-content {
  @apply flex;
  height: auto;
  padding: 8px 12px;
  padding-right: 32px;
  margin: 2px 0;
}

/* 弹出层箭头指向右侧 */
.menu__popup .menu__arrow {
  transform: rotate(-90deg);
}

/* 深色主题弹出层 */
:is(.menu__popup--dark, .menu__popup[data-theme="dark"]) {
  --menu-popup-bg: var(--sidebar-dark);
  --menu-popup-border: var(--sidebar-dark-border);
  --menu-item-color: hsl(var(--sidebar-dark-foreground) / 0.8);
  --menu-item-hover-color: var(--sidebar-dark-foreground);
  --menu-item-hover-bg: hsl(var(--sidebar-dark-foreground) / 0.1);
  --menu-item-active-color: var(--primary-foreground);
  --menu-item-active-bg: var(--primary);
}

/* ============================================================
 * 垂直模式子列表
 * ============================================================ */
.menu__sub-list {
  @apply flex flex-col p-0 m-0 list-none overflow-hidden;
  content-visibility: auto;
  contain-intrinsic-size: 400px 600px;
}

/* ============================================================
 * 徽章样式
 * ============================================================ */
.menu__badge {
  @apply inline-flex items-center justify-center text-[10px] font-medium;
  min-width: 18px;
  height: 18px;
  padding: 0 6px;
  margin-left: 8px;
  color: var(--primary-foreground);
  background-color: var(--primary);
  border-radius: 9px;
}

:is(.menu__badge--dot, .menu__badge[data-badge="dot"]) {
  width: 6px;
  height: 6px;
  min-width: 6px;
  padding: 0;
  background-color: var(--destructive);
  border-radius: 50%;
}

:is(.menu__badge--warning, .menu__badge[data-badge="warning"]) {
  background-color: var(--warning);
}

:is(.menu__badge--success, .menu__badge[data-badge="success"]) {
  background-color: var(--success);
}

/* ============================================================
 * 响应式
 * ============================================================ */
@media (max-width: 1024px) {
  .menu__name {
    max-width: 100px;
  }
}

@media (max-width: 768px) {
  :is(.menu--horizontal, .menu[data-mode="horizontal"]) {
    display: none;
  }
}

/* ============================================================
   混合侧边栏菜单样式
   ============================================================ */

.mixed-sidebar-menu {
  @apply h-full flex flex-col overflow-y-auto;
  content-visibility: auto;
  contain-intrinsic-size: 600px 800px;
  /* 使用公共滚动条样式，深色背景使用亮色滚动条 */
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}

.mixed-sidebar-menu:hover {
  scrollbar-color: var(--scrollbar-thumb-dark) transparent;
}

.mixed-sidebar-menu::-webkit-scrollbar {
  width: var(--scrollbar-width);
}

.mixed-sidebar-menu::-webkit-scrollbar-track {
  background: transparent;
}

.mixed-sidebar-menu::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: var(--scrollbar-radius);
  transition: background-color 0.5s ease;
}

.mixed-sidebar-menu:hover::-webkit-scrollbar-thumb,
.mixed-sidebar-menu::-webkit-scrollbar-thumb:hover,
.mixed-sidebar-menu:hover::-webkit-scrollbar-thumb:hover {
  background-color: var(--scrollbar-thumb-dark);
}

/* 混合侧边栏 Logo 区域 */
.mixed-sidebar-menu__logo {
  padding: 0.5rem;
  @apply flex items-center justify-center;
  border-bottom: 1px solid var(--sidebar-dark-border);
  color: var(--sidebar-dark-foreground);
}

.mixed-sidebar-menu__logo img {
  max-width: 100%;
  height: auto;
}

:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) .mixed-sidebar-menu__logo {
  border-bottom-color: var(--sidebar-light-border);
  color: var(--sidebar-light-foreground);
}

.mixed-sidebar-menu__root {
  padding: 0.5rem 0;
  flex: 1;
  overflow-y: auto;
  content-visibility: auto;
  contain-intrinsic-size: 400px 600px;
}

.mixed-sidebar-menu__root-item {
  @apply flex flex-col items-center justify-center cursor-pointer relative;
  padding: 0.75rem 0.5rem;
  margin: 0.25rem 0.5rem;
  border-radius: 0.5rem;
  color: var(--sidebar-dark-muted);
  transition: background 0.15s ease, color 0.15s ease, transform 0.15s ease;
  content-visibility: auto;
  contain-intrinsic-size: 64px 80px;
}

.mixed-sidebar-menu__root-item:hover {
  background-color: color-mix(in oklch, var(--sidebar-dark-foreground) 8%, transparent);
  color: var(--sidebar-dark-foreground);
}

.mixed-sidebar-menu__root-item:hover .mixed-sidebar-menu__icon {
  transform: scale(1.1);
}

:is(.mixed-sidebar-menu__root-item--active, .mixed-sidebar-menu__root-item[data-state="active"]) {
  background-color: var(--primary) !important;
  color: var(--sidebar-dark-foreground) !important;
}

:is(.mixed-sidebar-menu__root-item--disabled, .mixed-sidebar-menu__root-item[data-disabled="true"]) {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

:is(.mixed-sidebar-menu__root-item--active, .mixed-sidebar-menu__root-item[data-state="active"])::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 60%;
  background-color: var(--primary);
  border-radius: 0 2px 2px 0;
  opacity: 0;
}

.mixed-sidebar-menu__icon {
  @apply flex items-center justify-center;
  width: 2rem;
  height: 2rem;
  font-size: 1.25rem;
  margin-bottom: 0.25rem;
  transition: transform 0.2s ease;
}

.mixed-sidebar-menu__root-name {
  @apply truncate text-[0.625rem] text-center;
  max-width: 100%;
  line-height: 1.2;
}

/* 混合侧边栏子菜单样式 */
.mixed-sidebar-submenu {
  @apply h-full flex flex-col bg-inherit;
}

.mixed-sidebar-submenu__title {
  padding: 1rem 1rem 0.75rem;
  font-size: 0.8125rem;
  font-weight: 600;
  color: var(--foreground, var(--sidebar-light-foreground));
  border-bottom: 1px solid var(--border);
  margin-bottom: 0.25rem;
  letter-spacing: 0.02em;
}

.mixed-sidebar-submenu__nav {
  flex: 1;
  overflow-y: auto;
  padding: 0.375rem 0.5rem;
  content-visibility: auto;
  contain-intrinsic-size: 600px 800px;
  /* 使用公共滚动条样式 */
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}

.mixed-sidebar-submenu__nav:hover {
  scrollbar-color: var(--scrollbar-thumb) transparent;
}

.mixed-sidebar-submenu__nav::-webkit-scrollbar {
  width: var(--scrollbar-width);
}

.mixed-sidebar-submenu__nav::-webkit-scrollbar-track {
  background: transparent;
}

.mixed-sidebar-submenu__nav::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: var(--scrollbar-radius);
  transition: background-color 0.5s ease;
}

.mixed-sidebar-submenu__nav:hover::-webkit-scrollbar-thumb,
.mixed-sidebar-submenu__nav::-webkit-scrollbar-thumb:hover,
.mixed-sidebar-submenu__nav:hover::-webkit-scrollbar-thumb:hover {
  background-color: var(--scrollbar-thumb);
}

.mixed-sidebar-submenu__item {
  @apply flex items-center cursor-pointer text-sm relative;
  padding: 0.5rem 0.75rem;
  margin: 0.125rem 0;
  border-radius: 0.375rem;
  color: var(--foreground, var(--muted-foreground));
  transition: background 0.15s ease, color 0.15s ease, padding 0.15s ease;
  content-visibility: auto;
  contain-intrinsic-size: 36px 240px;
}

.mixed-sidebar-submenu__item:hover {
  background-color: color-mix(in oklch, var(--foreground) 4%, transparent);
  color: var(--foreground, var(--sidebar-light-foreground));
  padding-left: 0.875rem;
}

:is(.mixed-sidebar-submenu__item--active, .mixed-sidebar-submenu__item[data-state="active"]) {
  background-color: hsl(var(--primary, 217 91% 60%) / 0.12) !important;
  color: var(--primary) !important;
  font-weight: 500;
}

:is(.mixed-sidebar-submenu__item--active, .mixed-sidebar-submenu__item[data-state="active"])::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 60%;
  background-color: var(--primary);
  border-radius: 0 2px 2px 0;
}

/* 原有的 active 带背景色样式改为深色模式使用 */
:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) :is(.mixed-sidebar-submenu__item--active, .mixed-sidebar-submenu__item[data-state="active"]) {
  background-color: var(--primary) !important;
  color: var(--sidebar-dark-foreground) !important;
}

:is(.mixed-sidebar-submenu__item--has-active-child, .mixed-sidebar-submenu__item[data-has-active-child="true"]) {
  color: var(--primary);
}

:is(.mixed-sidebar-submenu__item--disabled, .mixed-sidebar-submenu__item[data-disabled="true"]) {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

.mixed-sidebar-submenu__icon {
  @apply flex items-center justify-center shrink-0;
  width: 1.25rem;
  margin-right: 0.5rem;
}

.mixed-sidebar-submenu__name {
  @apply flex-1 truncate;
}

.mixed-sidebar-submenu__arrow {
  @apply flex items-center ml-2 shrink-0 transition-transform;
}

:is(.mixed-sidebar-submenu__arrow--expanded, .mixed-sidebar-submenu__arrow[data-expanded="true"]) {
  transform: rotate(90deg);
}

.mixed-sidebar-submenu__children {
  margin-left: 0.75rem;
  border-left: 1px solid var(--border, color-mix(in oklch, var(--foreground) 10%, transparent));
  padding-left: 0.5rem;
}

:is(.mixed-sidebar-submenu__item--level-1, .mixed-sidebar-submenu__item[data-level="1"]) {
  padding-left: 1rem;
}

:is(.mixed-sidebar-submenu__item--level-2, .mixed-sidebar-submenu__item[data-level="2"]) {
  padding-left: 1.25rem;
}

/* 浅色主题下的混合菜单 */
:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) .mixed-sidebar-menu__root-item {
  color: var(--muted-foreground);
}

:is(.layout-sidebar--light, .layout-sidebar[data-theme="light"]) .mixed-sidebar-menu__root-item:hover {
  background-color: color-mix(in oklch, var(--foreground) 5%, transparent);
  color: var(--sidebar-light-foreground);
}

/* 深色主题下子菜单样式 */
:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__title {
  color: color-mix(in oklch, var(--sidebar-dark-foreground) 90%, transparent);
  border-bottom-color: color-mix(in oklch, var(--sidebar-dark-foreground) 10%, transparent);
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__item {
  color: color-mix(in oklch, var(--sidebar-dark-foreground) 70%, transparent);
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__item:hover {
  background-color: color-mix(in oklch, var(--sidebar-dark-foreground) 10%, transparent);
  color: var(--sidebar-dark-foreground);
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) :is(.mixed-sidebar-submenu__item--active, .mixed-sidebar-submenu__item[data-state="active"]) {
  background-color: var(--primary) !important;
  color: var(--sidebar-dark-foreground) !important;
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) :is(.mixed-sidebar-submenu__item--has-active-child, .mixed-sidebar-submenu__item[data-has-active-child="true"]) {
  color: var(--primary);
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__children {
  border-left-color: color-mix(in oklch, var(--sidebar-dark-foreground) 10%, transparent);
}

/* 子菜单面板按钮（类似常见 admin 布局） */
/* 折叠按钮 - 左下角 */
.mixed-sidebar-submenu__collapse-btn {
  @apply absolute bottom-2 left-3 flex items-center justify-center cursor-pointer;
  z-index: var(--layout-z-index-fixed);
  padding: 0.25rem;
  border-radius: 0.25rem;
  color: var(--foreground, var(--muted-foreground));
  opacity: 0.6;
  background-color: var(--accent);
  border: none;
  transition: background 0.15s ease, opacity 0.15s ease, color 0.15s ease;
}

.mixed-sidebar-submenu__collapse-btn:hover {
  background-color: var(--menu-item-hover);
  opacity: 1;
  color: var(--foreground, var(--sidebar-light-foreground));
}

/* 固定按钮 - 右下角 */
.mixed-sidebar-submenu__pin-btn {
  @apply absolute bottom-2 right-3 flex items-center justify-center cursor-pointer;
  z-index: var(--layout-z-index-fixed);
  padding: 5px;
  border-radius: 0.25rem;
  color: var(--foreground, var(--muted-foreground));
  opacity: 0.6;
  background-color: var(--accent);
  border: none;
  transition: background 0.15s ease, opacity 0.15s ease, color 0.15s ease;
}

.mixed-sidebar-submenu__pin-btn:hover {
  background-color: var(--menu-item-hover);
  opacity: 1;
  color: var(--foreground, var(--sidebar-light-foreground));
}

/* 折叠状态下按钮居中 */
:is(.mixed-sidebar-submenu--collapsed, .mixed-sidebar-submenu[data-collapsed="true"]) .mixed-sidebar-submenu__collapse-btn {
  left: 50%;
  transform: translateX(-50%);
}

/* 深色主题下的按钮 */
:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__collapse-btn,
:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__pin-btn {
  color: var(--sidebar-dark-muted);
  background-color: color-mix(in oklch, var(--sidebar-dark-foreground) 8%, transparent);
}

:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__collapse-btn:hover,
:is(.layout-sidebar--dark, .layout-sidebar[data-theme="dark"]) .mixed-sidebar-submenu__pin-btn:hover {
  background-color: color-mix(in oklch, var(--sidebar-dark-foreground) 15%, transparent);
  color: var(--sidebar-dark-foreground);
}

/* ============================================================
 * 顶栏工具组件样式
 * ============================================================ */

/* 顶栏右侧按钮统一颜色变量 */
.layout-header {
  --header-widget-hover-bg: hsl(var(--accent));
  --header-widget-hover-fg: var(--primary);
  --header-widget-hover-border: hsl(var(--border));
  --header-widget-active-bg: hsl(var(--accent));
  --header-widget-active-fg: var(--primary);
  --header-widget-active-border: hsl(var(--border));
  --header-dropdown-bg: var(--background, #ffffff);
  --header-dropdown-fg: var(--foreground, #0f172a);
  --header-dropdown-border: var(--border, #e2e8f0);
  --header-dropdown-accent-bg: var(--accent, #f1f5f9);
  --header-dropdown-accent-fg: var(--accent-foreground, #0f172a);
  --header-dropdown-shadow: 0 4px 12px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(0, 0, 0, 0.04);
  --header-dropdown-radius: 0.375rem;
  --header-dropdown-padding: 0.25rem;
  --header-dropdown-item-radius: 0.125rem;
  --header-dropdown-item-padding: 0.375rem 0.5rem;
  --header-dropdown-width: 8rem;
  --header-notification-width: 18rem;
  --header-search-modal-width: 40rem;
  --header-search-modal-bg: var(--card, var(--background, #ffffff));
  --header-search-modal-border: var(--header-dropdown-border);
  --header-search-modal-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
  --header-search-modal-radius: 0.75rem;
  --header-search-bg: color-mix(in oklch, var(--muted) 68%, var(--background));
  --header-search-hover-bg: color-mix(in oklch, var(--muted) 80%, var(--background));
  --header-search-border: transparent;
  --header-widget-fg: var(--foreground);
  --header-widget-muted-fg: var(--muted-foreground);
  --header-widget-disabled-opacity: 0.45;
  --header-widget-size: 36px;
  --header-widget-radius: 8px;
  --header-search-height: 32px;
  --header-search-radius: 16px;
  --header-search-padding-x: 8px;
  --header-search-gap: 12px;
  --header-toolbar-gap: 4px;
  /* 顶栏图标整体再大一点，提升可读性 */
  --header-widget-icon-size: 18px;
  --header-widget-lift: -1px;
  --header-widget-press-scale: 0.96;
  --header-widget-icon-scale: 1.05;
  --header-widget-icon-scale-active: 0.98;
  --header-widget-icon-scale-open: 1.02;
  --header-widget-shadow: 0 0 0 0 transparent;
  --header-widget-shadow-hover: 0 6px 16px
    color-mix(in oklch, var(--primary) 12%, transparent);
  --header-widget-shadow-active: 0 2px 8px
    color-mix(in oklch, var(--primary) 10%, transparent);
  --header-widget-shadow-open: 0 8px 18px
    color-mix(in oklch, var(--primary) 14%, transparent);
  --header-widget-font-size: 12px;
  --header-widget-font-weight: 500;
  --header-user-text-max-width: 96px;
  --header-search-kbd-font-size: 11px;
  --header-search-kbd-radius: 6px;
  --header-search-gap: 8px;
  --header-user-gap: 8px;
  --header-user-padding: 4px 8px 4px 4px;
  --header-search-kbd-padding: 2px 6px;
  --header-search-kbd-bg: var(--background, #ffffff);
  --header-search-kbd-border: hsl(var(--foreground) / 0.6);
  --header-search-kbd-fg: var(--muted-foreground);
  --header-widget-line-height: 1;
  --header-widget-border-width: 1px;
  --header-widget-focus-ring-width: 2px;
  --header-widget-focus-ring-offset: 0px;
  --header-search-border-width: 1px;
  --header-widget-focus-ring: color-mix(
    in oklch,
    var(--primary) 30%,
    transparent
  );
}

/* hover/active 视觉阶梯（浅 -> 深） */
.layout-header {
  --header-widget-hover-bg: color-mix(
    in oklch,
    var(--header-widget-hover-bg) 85%,
    transparent
  );
  --header-widget-active-bg: color-mix(
    in oklch,
    var(--header-widget-active-bg) 90%,
    transparent
  );
  --header-widget-hover-border: color-mix(
    in oklch,
    var(--header-widget-hover-border) 90%,
    transparent
  );
  --header-widget-active-border: color-mix(
    in oklch,
    var(--header-widget-active-border) 100%,
    transparent
  );
}

/* 深色顶栏下统一变量 */
:is(.layout-header--dark, .layout-header[data-theme="dark"]) {
  --header-widget-hover-bg: hsl(var(--foreground) / 0.1);
  --header-widget-hover-fg: hsl(var(--foreground));
  --header-widget-hover-border: hsl(var(--foreground) / 0.15);
  --header-widget-active-bg: hsl(var(--foreground) / 0.15);
  --header-widget-active-fg: hsl(var(--foreground));
  --header-widget-active-border: hsl(var(--foreground) / 0.2);
  --header-search-bg: color-mix(in oklch, currentColor 18%, transparent);
  --header-search-hover-bg: color-mix(in oklch, currentColor 26%, transparent);
  --header-search-border: color-mix(in oklch, currentColor 22%, transparent);
  --header-widget-fg: hsl(var(--foreground) / 0.9);
  --header-widget-muted-fg: hsl(var(--foreground) / 0.7);
  --header-search-kbd-bg: color-mix(in oklch, currentColor 14%, transparent);
  --header-search-kbd-border: color-mix(in oklch, currentColor 30%, transparent);
  --header-search-kbd-fg: color-mix(in oklch, currentColor 85%, transparent);
}

/* 工具栏容器 */
.header-toolbar {
  @apply flex items-center;
  gap: var(--header-toolbar-gap);
}

/* 工具按钮基础样式 */
.header-widget-btn {
  @apply flex items-center justify-center p-0 cursor-pointer transition-colors;
  height: var(--header-widget-size);
  width: var(--header-widget-size);
  border-radius: var(--header-widget-radius);
  line-height: var(--header-widget-line-height);
  color: var(--header-widget-fg);
  background: transparent;
  border: none;
  box-shadow: var(--header-widget-shadow);
  transition-property:
    color,
    background-color,
    border-color,
    transform,
    box-shadow,
    opacity;
  transition-duration: var(--admin-duration-fast, 150ms);
  transition-timing-function: var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
  will-change: transform;
}

.header-widget-btn:hover {
  background-color: var(--header-widget-hover-bg);
  color: var(--header-widget-hover-fg);
  box-shadow: var(--header-widget-shadow-hover);
  transform: translateY(var(--header-widget-lift));
}

.header-widget-btn[data-state="open"] {
  background-color: var(--header-widget-active-bg);
  color: var(--header-widget-active-fg);
  box-shadow: var(--header-widget-shadow-open);
  transform: translateY(0);
}

.header-widget-btn:active {
  background-color: var(--header-widget-active-bg);
  color: var(--header-widget-active-fg);
  box-shadow: var(--header-widget-shadow-active);
  transform: translateY(0) scale(var(--header-widget-press-scale));
}

.header-widget-btn:disabled,
.header-widget-btn[aria-disabled="true"] {
  opacity: var(--header-widget-disabled-opacity);
  cursor: not-allowed;
  pointer-events: none;
  box-shadow: none;
  transform: none;
}

.header-widget-btn:focus-visible,
.header-search-btn:focus-visible,
.header-widget-user:focus-visible {
  outline: none;
  box-shadow: 0 0 0 var(--header-widget-focus-ring-width)
    var(--header-widget-focus-ring);
  outline-offset: var(--header-widget-focus-ring-offset);
}

.header-search-btn,
.header-widget-user {
  font-size: var(--header-widget-font-size);
  font-weight: var(--header-widget-font-weight);
}

.header-widget-user span {
  max-width: var(--header-user-text-max-width);
}

.header-search-btn kbd {
  font-size: var(--header-search-kbd-font-size);
  border-radius: var(--header-search-kbd-radius);
  padding: var(--header-search-kbd-padding);
  background-color: var(--header-search-kbd-bg);
  border: 1px solid var(--header-search-kbd-border);
  color: var(--header-search-kbd-fg);
}

/* 下拉菜单容器 */
.header-widget-dropdown {
  position: relative;
}

.header-widget-dropdown__menu {
  z-index: var(--admin-z-index-popover, 1060);
  min-width: var(--header-dropdown-width);
  padding: var(--header-dropdown-padding);
  border-radius: var(--header-dropdown-radius);
  border: 1px solid var(--header-dropdown-border);
  background-color: var(--header-dropdown-bg);
  color: var(--header-dropdown-fg);
  box-shadow: var(--header-dropdown-shadow);
}

/* 透明连接区域 - 防止鼠标移动到下拉菜单时 mouseleave 被触发 */
.header-widget-dropdown__menu::before {
  content: '';
  position: absolute;
  top: -8px;
  left: 0;
  right: 0;
  height: 8px;
}

/* 使用 __content 包装器的下拉菜单 - 外层透明 */
.header-widget-dropdown__menu:has(.header-widget-dropdown__content) {
  padding: 0;
  border: none;
  background: transparent;
  box-shadow: none;
}

/* 下拉菜单内容区域 - 带背景和边框 */
.header-widget-dropdown__content {
  padding: var(--header-dropdown-padding);
  border-radius: var(--header-dropdown-radius);
  border: 1px solid var(--header-dropdown-border);
  background-color: var(--header-dropdown-bg);
  color: var(--header-dropdown-fg);
  box-shadow: var(--header-dropdown-shadow);
}

.header-widget-dropdown__menu--compact {
  min-width: var(--header-dropdown-width);
}

.header-widget-dropdown__menu--compact .header-widget-dropdown__content {
  padding: 0.25rem;
}

.header-widget-dropdown__menu--notification {
  width: var(--header-notification-width);
  padding: 0;
  border-radius: var(--header-dropdown-radius);
  border: 1px solid var(--header-dropdown-border);
  background-color: var(--header-dropdown-bg);
  color: var(--header-dropdown-fg);
  box-shadow: var(--header-dropdown-shadow);
}

.header-widget-dropdown__item {
  display: flex;
  width: 100%;
  align-items: center;
  gap: 0.5rem;
  padding: var(--header-dropdown-item-padding);
  border-radius: var(--header-dropdown-item-radius);
  font-size: 0.875rem;
  line-height: 1.25rem;
  cursor: pointer;
  background: transparent;
  border: none;
  color: var(--header-dropdown-fg);
  transition: color var(--admin-duration-fast, 150ms)
      var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    background-color var(--admin-duration-fast, 150ms)
      var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.header-widget-dropdown__item:hover,
.header-widget-dropdown__item:focus-visible,
.header-widget-dropdown__item[data-selected="true"] {
  background-color: var(--header-dropdown-accent-bg);
  color: var(--header-dropdown-accent-fg);
}

.header-notification__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  border-bottom: 1px solid var(--header-dropdown-border);
}

.header-notification__meta {
  font-size: 0.75rem;
  color: var(--muted-foreground);
}

.header-notification__list {
  max-height: 20rem;
  overflow-y: auto;
}

.header-notification__empty {
  padding: 2rem 1rem;
  text-align: center;
  color: var(--muted-foreground);
}

.header-notification__item {
  position: absolute;
  left: 0;
  right: 0;
  display: flex;
  cursor: pointer;
  align-items: flex-start;
  gap: 1.25rem;
  padding: 0.75rem 1rem;
  border-top: 1px solid var(--header-dropdown-border);
  transition: background-color var(--admin-duration-fast, 150ms)
    var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.header-notification__item:hover {
  background-color: var(--header-dropdown-accent-bg);
}

.header-notification__item[data-read="false"] {
  background-color: color-mix(in oklch, var(--primary) 6%, transparent);
}

.header-notification__unread-dot {
  height: 0.5rem;
  width: 0.5rem;
  border-radius: 9999px;
  background-color: hsl(var(--primary));
}

.header-notification__description {
  margin-top: 0.125rem;
  font-size: 0.875rem;
  color: var(--muted-foreground);
}

.header-notification__time {
  margin-top: 0.25rem;
  font-size: 0.75rem;
  color: var(--muted-foreground);
}

.header-notification__footer {
  display: flex;
  border-top: 1px solid var(--header-dropdown-border);
}

.header-notification__footer-button {
  flex: 1;
  padding: 0.625rem 0;
  font-size: 0.875rem;
  color: var(--muted-foreground);
  background: transparent;
  border: none;
  transition: color var(--admin-duration-fast, 150ms)
      var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
    background-color var(--admin-duration-fast, 150ms)
      var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.header-notification__footer-button:hover {
  background-color: var(--header-dropdown-accent-bg);
  color: var(--header-dropdown-accent-fg);
}

.header-notification__divider {
  width: 1px;
  background-color: var(--header-dropdown-border);
}

/* 搜索弹窗样式 */
.header-search-overlay {
  position: fixed;
  inset: 0;
  z-index: var(--admin-z-index-modal, 1050);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 5rem 1rem 1rem;
}

.header-search-backdrop {
  position: absolute;
  inset: 0;
  background-color: color-mix(in oklch, var(--foreground) 50%, transparent);
}

.header-search-modal {
  width: 100%;
  max-width: var(--header-search-modal-width, 40rem);
  background-color: var(--header-search-modal-bg, var(--card, var(--background, #ffffff)));
  border: 1px solid var(--header-search-modal-border, var(--border, #e2e8f0));
  box-shadow: var(--header-search-modal-shadow, 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1));
  border-radius: var(--header-search-modal-radius, 0.75rem);
  overflow: hidden;
  position: relative;
  z-index: 1;
}

.header-search-modal__input-wrapper {
  display: flex;
  align-items: center;
  padding: 0 1rem;
  border-bottom: 1px solid var(--header-dropdown-border, var(--border, #e2e8f0));
}

.header-search-modal__input {
  flex: 1;
  border: 0;
  background: transparent;
  padding: 1rem 0.75rem;
  font-size: 1rem;
  outline: none;
  color: var(--foreground);
}

.header-search-modal__input::placeholder {
  color: var(--muted-foreground);
}

.header-search-modal__results {
  max-height: 24rem;
  overflow-y: auto;
  padding: 0.5rem;
}

.header-search-modal__item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem 1rem;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: all var(--admin-duration-fast);
}

.header-search-modal__item[data-selected="true"] {
  background-color: var(--header-dropdown-accent-bg, var(--accent, #f1f5f9));
  color: var(--header-dropdown-accent-fg, var(--accent-foreground, #0f172a));
}

.header-search-modal__item-icon {
  display: flex;
  height: 2rem;
  width: 2rem;
  align-items: center;
  justify-content: center;
  border-radius: 0.375rem;
  background-color: color-mix(in oklch, var(--foreground) 5%, transparent);
  font-size: 1.125rem;
}

.header-search-modal__item[data-selected="true"] .header-search-modal__item-icon {
  background-color: color-mix(in oklch, var(--primary) 15%, transparent);
}

.header-search-modal__item-content {
  flex: 1;
  overflow: hidden;
}

.header-search-modal__item-title {
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.header-search-modal__item-path {
  font-size: 0.75rem;
  color: var(--muted-foreground);
  margin-top: 0.125rem;
}

.header-search-modal__footer {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.5rem 1rem;
  border-top: 1px solid var(--header-dropdown-border, var(--border, #e2e8f0));
  font-size: 0.75rem;
  color: var(--muted-foreground);
}

.header-search-modal__footer-item {
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

.header-search-modal__kbd {
  padding: 0.125rem 0.375rem;
  border-radius: 0.25rem;
  border: 1px solid var(--header-dropdown-border, var(--border, #e2e8f0));
  background-color: color-mix(in oklch, var(--foreground) 5%, transparent);
  font-family: inherit;
  font-size: 0.625rem;
}

/* 搜索按钮特殊样式 */
.header-search-btn {
  @apply flex items-center text-xs cursor-pointer transition-colors;
  height: var(--header-search-height);
  padding: 0 var(--header-search-padding-x);
  border-radius: var(--header-search-radius);
  gap: var(--header-search-gap);
  line-height: var(--header-widget-line-height);
  color: var(--header-widget-muted-fg);
  background-color: transparent;
  border: 0;
  box-shadow: none;
  transition-property:
    color,
    background-color,
    border-color,
    transform,
    box-shadow,
    opacity;
  transition-duration: var(--admin-duration-fast, 150ms);
  transition-timing-function: var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
  will-change: transform;
}

.header-search-btn:hover {
  background-color: var(--header-search-hover-bg);
  border-color: var(--header-search-border);
  color: var(--header-widget-hover-fg);
  box-shadow: var(--header-widget-shadow-hover);
  transform: translateY(var(--header-widget-lift));
}

@media (min-width: 768px) {
  .header-search-btn {
    background-color: var(--header-search-bg);
    border: var(--header-widget-border-width) solid var(--header-search-border);
  }
}

.header-search-btn[data-state="open"] {
  background-color: var(--header-widget-active-bg);
  border-color: var(--header-widget-active-border);
  color: var(--header-widget-active-fg);
  box-shadow: var(--header-widget-shadow-open);
  transform: translateY(0);
}

.header-search-btn:active {
  background-color: var(--header-widget-active-bg);
  border-color: var(--header-widget-active-border);
  color: var(--header-widget-active-fg);
  box-shadow: var(--header-widget-shadow-active);
  transform: translateY(0) scale(var(--header-widget-press-scale));
}

.header-search-btn:disabled,
.header-search-btn[aria-disabled="true"] {
  opacity: var(--header-widget-disabled-opacity);
  cursor: not-allowed;
  pointer-events: none;
  box-shadow: none;
  transform: none;
}

/* 用户按钮特殊样式 */
.header-widget-user {
  @apply flex items-center cursor-pointer transition-colors;
  padding: var(--header-user-padding);
  border-radius: var(--header-widget-radius);
  gap: var(--header-user-gap);
  background: transparent;
  border: none;
  line-height: var(--header-widget-line-height);
  color: var(--header-widget-fg);
  box-shadow: var(--header-widget-shadow);
  transition-property:
    color,
    background-color,
    border-color,
    transform,
    box-shadow,
    opacity;
  transition-duration: var(--admin-duration-fast, 150ms);
  transition-timing-function: var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
  will-change: transform;
}

.header-widget-user:hover {
  background-color: var(--header-widget-hover-bg);
  box-shadow: var(--header-widget-shadow-hover);
  transform: translateY(var(--header-widget-lift));
}

.header-widget-user[data-state="open"] {
  background-color: var(--header-widget-active-bg);
  color: var(--header-widget-active-fg);
  box-shadow: var(--header-widget-shadow-open);
  transform: translateY(0);
}

.header-widget-user:active {
  background-color: var(--header-widget-active-bg);
  color: var(--header-widget-active-fg);
  box-shadow: var(--header-widget-shadow-active);
  transform: translateY(0) scale(var(--header-widget-press-scale));
}

.header-widget-user:disabled,
.header-widget-user[aria-disabled="true"] {
  opacity: var(--header-widget-disabled-opacity);
  cursor: not-allowed;
  pointer-events: none;
  box-shadow: none;
  transform: none;
}

/* 统一右侧按钮动效 - 图标过渡 */
.header-widget-btn svg,
.header-widget-user svg,
.header-search-btn svg {
  width: var(--header-widget-icon-size);
  height: var(--header-widget-icon-size);
  transition: transform var(--admin-duration-fast, 150ms)
    var(--admin-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

/* 排除动画状态（refreshing/spinning）的hover效果，避免transform冲突 */
.header-widget-btn:not([data-state="refreshing"]):not([data-state="spinning"]):hover svg,
.header-widget-user:hover svg,
.header-search-btn:hover svg {
  transform: scale(var(--header-widget-icon-scale));
}

/* 排除动画状态（refreshing/spinning）的active效果，避免transform冲突 */
.header-widget-btn:not([data-state="refreshing"]):not([data-state="spinning"]):active svg,
.header-widget-user:active svg,
.header-search-btn:active svg {
  transform: scale(var(--header-widget-icon-scale-active));
}

.header-widget-btn[data-state="open"] svg,
.header-widget-user[data-state="open"] svg,
.header-search-btn[data-state="open"] svg {
  transform: scale(var(--header-widget-icon-scale-open));
}

/* 主题切换按钮（参考 web.dev 风格图标动画） */
.header-widget-btn.theme-toggle .sun-and-moon {
  /* 稍微缩小一点，让视觉上与其他图标保持一致 */
  width: calc(var(--header-widget-icon-size) - 2px) !important;
  height: calc(var(--header-widget-icon-size) - 2px) !important;
  display: block;
}

.theme-toggle .sun-and-moon :is(.moon, .sun, .sun-beams) {
  transform-origin: center;
}

.theme-toggle .sun-and-moon :is(.moon, .sun) {
  fill: currentColor;
  opacity: 0.9;
}

.theme-toggle:is(:hover, :focus-visible) .sun-and-moon :is(.moon, .sun) {
  opacity: 1;
}

.theme-toggle .sun-and-moon .sun-beams {
  stroke: currentColor;
  stroke-width: 2px;
  opacity: 0.9;
}

.theme-toggle .sun-and-moon .sun-beams line {
  stroke-linecap: round;
}

.theme-toggle:is(:hover, :focus-visible) .sun-and-moon .sun-beams {
  opacity: 1;
}

/* 浅色模式 - 显示月亮（点击切换到深色） */
.theme-toggle.is-light .sun-and-moon .sun {
  transform: scale(1.75);
}

.theme-toggle.is-light .sun-and-moon .sun-beams {
  opacity: 0;
}

.theme-toggle.is-light .sun-and-moon .moon > circle {
  transform: translateX(-7px);
}

@supports (cx: 1) {
  .theme-toggle.is-light .sun-and-moon .moon > circle {
    cx: 17;
    transform: translateX(0);
  }
}

/* 动画过渡 - 仅在非减少运动模式下启用 */
@media (prefers-reduced-motion: no-preference) {
  .theme-toggle .sun-and-moon .sun {
    transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .theme-toggle .sun-and-moon .sun-beams {
    transition:
      transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
      opacity 0.5s cubic-bezier(0.25, 0, 0.3, 1);
  }

  .theme-toggle .sun-and-moon .moon > circle {
    transition: transform 0.25s cubic-bezier(0, 0, 0, 1);
  }

  @supports (cx: 1) {
    .theme-toggle .sun-and-moon .moon > circle {
      transition: cx 0.25s cubic-bezier(0, 0, 0, 1);
    }
  }

  /* 浅色模式过渡调整（显示月亮） */
  .theme-toggle.is-light .sun-and-moon .sun {
    transition-timing-function: cubic-bezier(0.25, 0, 0.3, 1);
    transition-duration: 0.25s;
  }

  .theme-toggle.is-light .sun-and-moon .sun-beams {
    transition-duration: 0.15s;
    transform: rotateZ(-25deg);
  }

  .theme-toggle.is-light .sun-and-moon .moon > circle {
    transition-duration: 0.5s;
    transition-delay: 0.25s;
  }
}


@media (prefers-reduced-motion: reduce) {
  .header-widget-btn,
  .header-widget-user,
  .header-search-btn {
    transition: none;
    transform: none;
  }

  .header-widget-btn:hover,
  .header-widget-user:hover,
  .header-search-btn:hover,
  .header-widget-btn[data-state="open"],
  .header-widget-user[data-state="open"],
  .header-search-btn[data-state="open"],
  .header-widget-btn:active,
  .header-widget-user:active,
  .header-search-btn:active {
    box-shadow: none;
    transform: none;
  }

  .header-widget-btn svg,
  .header-widget-user svg,
  .header-search-btn svg {
    transition: none;
    transform: none;
  }
}

/* 按钮点击旋转动画 */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes spin-settings {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* 刷新按钮旋转动画 */
:is(.header-widget-btn.animate-spin, .header-widget-btn[data-state="refreshing"]) svg {
  animation: spin var(--admin-duration-slow, 500ms) var(--admin-easing-default, ease-in-out) forwards !important;
  transform-origin: 50% 50%;
  transform-box: fill-box;
  transition: none !important;
}

/* 设置按钮 hover 旋转动画 - 鼠标移入持续旋转，移出停止 */
.header-widget-btn[data-widget="preferences"]:hover svg {
  animation: spin-settings 1.5s linear infinite;
  transform-origin: center;
  transform-box: fill-box;
}

.header-widget-btn[data-widget="preferences"] svg {
  transition: transform var(--admin-duration-fast, 150ms) var(--admin-easing-default, ease);
}
