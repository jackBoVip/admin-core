/**
 * Drawer Container Styles - Tailwind CSS v4 优化版
 * @description Main container, overlay, content area layout
 *
 * Tailwind v4 特性利用：
 * - CSS 原生嵌套
 * - 容器查询 (@container) 实现组件级响应式
 * - light-dark() 函数
 * - color-mix() 动态颜色
 */

@layer admin-core {
  /* ========== 抽屉容器 ========== */
  .preferences-drawer {
    /* 声明为容器，支持容器查询 */
    container-type: inline-size;
    container-name: drawer;

    position: fixed;
    top: 0;
    right: 0;
    z-index: var(--admin-z-index-modal, 1050);
    display: flex;
    flex-direction: column;
    width: var(--admin-drawer-width, 384px);
    max-width: 100vw;
    height: 100vh;
    height: 100dvh; /* 动态视口高度，移动端更准确 */
    background: var(--background);
    border-left: none;
    box-shadow: 
      -16px 0 32px -8px color-mix(in oklch, var(--foreground) 10%, transparent),
      -8px 0 16px -4px color-mix(in oklch, var(--foreground) 6%, transparent);
    
    /* GPU 加速优化 */
    transform: translate3d(100%, 0, 0);
    will-change: transform;
    backface-visibility: hidden;
    
    /* 使用更流畅的 cubic-bezier 曲线 */
    transition: transform 280ms cubic-bezier(0.32, 0.72, 0, 1);

    /* 打开状态 */
    &.open,
    &[data-state="open"] {
      transform: translate3d(0, 0, 0);
    }

    /* 移动端响应式 - 全屏宽度 */
    @media (max-width: 480px) {
      width: 100vw;
      border-radius: 0;
    }
  }

  /* ========== 遮罩层 ========== */
  .preferences-drawer-overlay {
    position: fixed;
    inset: 0;
    z-index: calc(var(--admin-z-index-modal, 1050) - 1);
    /* 使用 light-dark() 函数 */
    background: light-dark(
      color-mix(in oklch, var(--foreground) 40%, transparent),
      color-mix(in oklch, var(--foreground) 60%, transparent)
    );
    
    /* GPU 加速优化 */
    opacity: 0;
    visibility: hidden;
    will-change: opacity;
    backface-visibility: hidden;
    
    /* 更快的过渡时间 */
    transition: 
      opacity 200ms ease-out, 
      visibility 200ms ease-out;
    
    /* 移除 backdrop-filter 以提升性能，改用更高的不透明度 */
    /* backdrop-filter: blur(2px); */

    &.open,
    &[data-state="open"] {
      opacity: 1;
      visibility: visible;
    }
  }

  /* ========== 内容区域 ========== */
  .preferences-drawer-body {
    flex: 1;
    overflow-y: scroll;
    overflow-x: hidden;
    padding: 12px 24px;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;

    /* Webkit 滚动条样式（使用嵌套） */
    &::-webkit-scrollbar {
      width: 6px;
    }

    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 3px;

      &:hover {
        background: var(--muted-foreground);
      }
    }

    /* 容器查询 - 窄屏时减少内边距 */
    @container drawer (max-width: 360px) {
      padding: 8px 16px;
    }
  }

  /* ========== 页脚 ========== */
  .preferences-drawer-footer {
    display: flex;
    flex-shrink: 0;
    gap: 12px;
    padding: 16px 24px;
    border-top: 1px solid var(--border);
    background: var(--background);

    .preferences-btn {
      flex: 1;
    }

    /* 容器查询 - 窄屏时调整内边距 */
    @container drawer (max-width: 360px) {
      padding: 12px 16px;
      gap: 8px;
    }
  }
}
