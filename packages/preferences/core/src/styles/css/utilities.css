/**
 * Utility Styles - Tailwind CSS v4 优化版
 * @description 使用 @utility 指令创建自定义工具类
 *
 * Tailwind v4 特性利用：
 * - @utility 指令定义自定义工具类
 * - CSS 原生嵌套
 * - 自动与 Tailwind 工具类系统集成
 */

/* ========== 自定义工具类（使用 @utility 指令） ========== */

/* 滚动条样式 - 可通过 Tailwind 类使用，如 class="scrollbar-thin" */
@utility scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: var(--muted-foreground) transparent;

  &::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  &::-webkit-scrollbar-track {
    background: transparent;
  }

  &::-webkit-scrollbar-thumb {
    background: var(--muted-foreground);
    border-radius: 3px;

    &:hover {
      background: var(--foreground);
    }
  }
}

@utility scrollbar-none {
  scrollbar-width: none;
  -ms-overflow-style: none;

  &::-webkit-scrollbar {
    display: none;
  }
}

/* 自定义滚动条 - 默认隐藏，悬停/滚动时显示 */
@utility scrollbar-elegant {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
  transition: scrollbar-color 0.5s ease;

  &:hover {
    scrollbar-color: var(--scrollbar-thumb) transparent;
  }
}

/* Webkit 滚动条基础样式 */
.scrollbar-elegant::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
}

.scrollbar-elegant::-webkit-scrollbar-track {
  background: transparent;
  border-radius: var(--scrollbar-radius);
}

.scrollbar-elegant::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: var(--scrollbar-radius);
  transition: background-color 0.5s ease;
}

/* 悬停时显示滚动条 - 所有状态使用统一颜色 */
.scrollbar-elegant:hover::-webkit-scrollbar-thumb {
  background-color: var(--scrollbar-thumb);
}

/* 鼠标直接在滚动条上时 - 使用相同颜色 */
.scrollbar-elegant::-webkit-scrollbar-thumb:hover,
.scrollbar-elegant:hover::-webkit-scrollbar-thumb:hover {
  background-color: var(--scrollbar-thumb);
}

:is(.scrollbar-elegant.is-scrolling, .scrollbar-elegant[data-scrolling="true"])::-webkit-scrollbar-thumb {
  background-color: var(--scrollbar-thumb);
}

/* 灰色模式（哀悼模式） */
@utility grayscale-mode {
  filter: grayscale(100%);
}

/* 色弱模式（无障碍） */
@utility color-weak-mode {
  filter: invert(80%);
}

/* 禁止选择 */
@utility no-select {
  user-select: none;
}

/* 统一禁用态（依赖 data-disabled / aria-disabled / .disabled） */
@utility pref-disabled {
  &:where(:disabled),
  &:where([data-disabled="true"]),
  &:where([aria-disabled="true"]),
  &.disabled {
    opacity: 0.5;
    cursor: not-allowed;

    & * {
      cursor: not-allowed;
    }

    .pref-disabled-label {
      color: var(--muted-foreground);
    }

    .pref-disabled-trigger {
      background-color: var(--muted);
      border-color: var(--border);
      box-shadow: none;
      color: var(--muted-foreground);
    }
  }
}

/* 焦点可见环 */
@utility focus-ring {
  &:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
  }
}

/* 半深色模式 */
@utility semi-dark {
  --background: oklch(0.18 0.02 250);
  --foreground: oklch(0.92 0 0);
  --muted: oklch(0.22 0.02 250);
  --muted-foreground: oklch(0.6 0.02 250);
  --border: oklch(0.28 0.02 250);
}

/* ========== @layer 内的补充样式 ========== */
@layer admin-core {
  /* 全局模式应用到 html */
  html {
    &.grayscale-mode {
      filter: grayscale(100%);
    }

    &.color-weak-mode {
      filter: invert(80%);
    }
  }

  /* 文本截断工具类（Tailwind 已有，这里作为降级） */
  .truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* 过渡工具类（使用 CSS 变量） */
  .transition-colors {
    transition-property: color, background-color, border-color;
    transition-duration: var(--admin-duration-fast);
    transition-timing-function: var(--admin-easing-default);
  }

  .transition-opacity {
    transition-property: opacity;
    transition-duration: var(--admin-duration-fast);
    transition-timing-function: var(--admin-easing-default);
  }

  .transition-transform {
    transition-property: transform;
    transition-duration: var(--admin-duration-fast);
    transition-timing-function: var(--admin-easing-default);
  }

  /* 图标基础样式：保证 SVG 在容器内居中对齐 */
  .admin-icon {
    align-items: center;
    justify-content: center;
    line-height: 0;
  }

  .admin-icon svg {
    display: block;
  }
}
