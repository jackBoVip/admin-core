<script setup lang="ts">
import { useRouter, useRoute } from 'vue-router';
import {
  BasicLayout,
  useVueRouterAdapter,
  type MenuItem,
} from '@admin-core/layout-vue';

// ËèúÂçïÊï∞ÊçÆ
const menus: MenuItem[] = [
  {
    key: 'home',
    name: 'È¶ñÈ°µ',
    path: '/',
    icon: 'üè†',
    affix: true,
  },
  {
    key: 'dashboard',
    name: '‰ª™Ë°®Áõò',
    path: '/dashboard',
    icon: 'üìä',
    children: [
      {
        key: 'dashboard-analysis',
        name: 'ÂàÜÊûêÈ°µ',
        path: '/dashboard/analysis',
        icon: 'üìà',
      },
      {
        key: 'dashboard-monitor',
        name: 'ÁõëÊéßÈ°µ',
        path: '/dashboard/monitor',
        icon: 'üñ•Ô∏è',
      },
      {
        key: 'dashboard-workplace',
        name: 'Â∑•‰ΩúÂè∞',
        path: '/dashboard/workplace',
        icon: 'üíº',
      },
    ],
  },
  {
    key: 'system',
    name: 'Á≥ªÁªüÁÆ°ÁêÜ',
    path: '/system',
    icon: '‚öôÔ∏è',
    children: [
      {
        key: 'system-user',
        name: 'Áî®Êà∑ÁÆ°ÁêÜ',
        path: '/system/user',
        icon: 'üë§',
      },
      {
        key: 'system-role',
        name: 'ËßíËâ≤ÁÆ°ÁêÜ',
        path: '/system/role',
        icon: 'üë•',
      },
      {
        key: 'system-menu',
        name: 'ËèúÂçïÁÆ°ÁêÜ',
        path: '/system/menu',
        icon: 'üìã',
      },
      {
        key: 'system-dept',
        name: 'ÈÉ®Èó®ÁÆ°ÁêÜ',
        path: '/system/dept',
        icon: 'üè¢',
      },
      {
        key: 'system-dict',
        name: 'Â≠óÂÖ∏ÁÆ°ÁêÜ',
        path: '/system/dict',
        icon: 'üìñ',
      },
      {
        key: 'system-config',
        name: 'Á≥ªÁªüÈÖçÁΩÆ',
        path: '/system/config',
        icon: 'üîß',
      },
    ],
  },
  {
    key: 'permission',
    name: 'ÊùÉÈôêÁÆ°ÁêÜ',
    path: '/permission',
    icon: 'üîê',
    children: [
      {
        key: 'permission-page',
        name: 'È°µÈù¢ÊùÉÈôê',
        path: '/permission/page',
        icon: 'üìÑ',
      },
      {
        key: 'permission-button',
        name: 'ÊåâÈíÆÊùÉÈôê',
        path: '/permission/button',
        icon: 'üîò',
      },
      {
        key: 'permission-api',
        name: 'Êé•Âè£ÊùÉÈôê',
        path: '/permission/api',
        icon: 'üîå',
      },
    ],
  },
  {
    key: 'components',
    name: 'ÁªÑ‰ª∂Á§∫‰æã',
    path: '/components',
    icon: 'üß©',
    children: [
      {
        key: 'components-basic',
        name: 'Âü∫Á°ÄÁªÑ‰ª∂',
        icon: 'üì¶',
        children: [
          {
            key: 'components-button',
            name: 'ÊåâÈíÆ',
            path: '/components/button',
          },
          {
            key: 'components-icon',
            name: 'ÂõæÊ†á',
            path: '/components/icon',
          },
          {
            key: 'components-typography',
            name: 'ÊéíÁâà',
            path: '/components/typography',
          },
        ],
      },
      {
        key: 'components-form',
        name: 'Ë°®ÂçïÁªÑ‰ª∂',
        icon: 'üìù',
        children: [
          {
            key: 'components-input',
            name: 'ËæìÂÖ•Ê°Ü',
            path: '/components/input',
          },
          {
            key: 'components-select',
            name: 'ÈÄâÊã©Âô®',
            path: '/components/select',
          },
          {
            key: 'components-form-basic',
            name: 'Âü∫Á°ÄË°®Âçï',
            path: '/components/form',
          },
          {
            key: 'components-form-advanced',
            name: 'È´òÁ∫ßË°®Âçï',
            path: '/components/form-advanced',
          },
        ],
      },
      {
        key: 'components-data',
        name: 'Êï∞ÊçÆÂ±ïÁ§∫',
        icon: 'üìä',
        children: [
          {
            key: 'components-table',
            name: 'Ë°®Ê†º',
            path: '/components/table',
          },
          {
            key: 'components-tree',
            name: 'Ê†ëÂΩ¢Êéß‰ª∂',
            path: '/components/tree',
          },
          {
            key: 'components-card',
            name: 'Âç°Áâá',
            path: '/components/card',
          },
        ],
      },
      {
        key: 'components-feedback',
        name: 'ÂèçÈ¶àÁªÑ‰ª∂',
        icon: 'üí¨',
        children: [
          {
            key: 'components-modal',
            name: 'Ê®°ÊÄÅÊ°Ü',
            path: '/components/modal',
          },
          {
            key: 'components-message',
            name: 'Ê∂àÊÅØÊèêÁ§∫',
            path: '/components/message',
          },
          {
            key: 'components-notification',
            name: 'ÈÄöÁü•',
            path: '/components/notification',
          },
        ],
      },
    ],
  },
  {
    key: 'feature',
    name: 'ÂäüËÉΩÁ§∫‰æã',
    path: '/feature',
    icon: '‚ú®',
    children: [
      {
        key: 'feature-clipboard',
        name: 'Ââ™ÂàáÊùø',
        path: '/feature/clipboard',
        icon: 'üìã',
      },
      {
        key: 'feature-print',
        name: 'ÊâìÂç∞',
        path: '/feature/print',
        icon: 'üñ®Ô∏è',
      },
      {
        key: 'feature-excel',
        name: 'Excel ÂØºÂá∫',
        path: '/feature/excel',
        icon: 'üìó',
      },
      {
        key: 'feature-pdf',
        name: 'PDF È¢ÑËßà',
        path: '/feature/pdf',
        icon: 'üìï',
      },
      {
        key: 'feature-watermark',
        name: 'Ê∞¥Âç∞',
        path: '/feature/watermark',
        icon: 'üíß',
      },
      {
        key: 'feature-fullscreen',
        name: 'ÂÖ®Â±è',
        path: '/feature/fullscreen',
        icon: 'üñ•Ô∏è',
      },
    ],
  },
  {
    key: 'charts',
    name: 'ÂõæË°®',
    path: '/charts',
    icon: 'üìâ',
    children: [
      {
        key: 'charts-echarts',
        name: 'ECharts',
        path: '/charts/echarts',
        icon: 'üìä',
      },
      {
        key: 'charts-apexcharts',
        name: 'ApexCharts',
        path: '/charts/apexcharts',
        icon: 'üìà',
      },
      {
        key: 'charts-map',
        name: 'Âú∞Âõæ',
        path: '/charts/map',
        icon: 'üó∫Ô∏è',
      },
    ],
  },
  {
    key: 'nested',
    name: 'Â§öÁ∫ßËèúÂçï',
    path: '/nested',
    icon: 'üìÅ',
    children: [
      {
        key: 'nested-menu1',
        name: 'ËèúÂçï1',
        path: '/nested/menu1',
        children: [
          {
            key: 'nested-menu1-1',
            name: 'ËèúÂçï1-1',
            path: '/nested/menu1/menu1-1',
            children: [
              {
                key: 'nested-menu1-1-1',
                name: 'ËèúÂçï1-1-1',
                path: '/nested/menu1/menu1-1/menu1-1-1',
              },
              {
                key: 'nested-menu1-1-2',
                name: 'ËèúÂçï1-1-2',
                path: '/nested/menu1/menu1-1/menu1-1-2',
              },
            ],
          },
          {
            key: 'nested-menu1-2',
            name: 'ËèúÂçï1-2',
            path: '/nested/menu1/menu1-2',
          },
        ],
      },
      {
        key: 'nested-menu2',
        name: 'ËèúÂçï2',
        path: '/nested/menu2',
      },
    ],
  },
  {
    key: 'external',
    name: 'Â§ñÈÉ®ÈìæÊé•',
    icon: 'üîó',
    children: [
      {
        key: 'external-github',
        name: 'GitHub',
        externalLink: 'https://github.com',
        openInNewWindow: true,
        icon: 'üêô',
      },
      {
        key: 'external-vue',
        name: 'Vue ÊñáÊ°£',
        externalLink: 'https://vuejs.org',
        openInNewWindow: true,
        icon: 'üíö',
      },
      {
        key: 'external-vite',
        name: 'Vite ÊñáÊ°£',
        externalLink: 'https://vitejs.dev',
        openInNewWindow: true,
        icon: '‚ö°',
      },
    ],
  },
  {
    key: 'about',
    name: 'ÂÖ≥‰∫é',
    path: '/about',
    icon: '‚ÑπÔ∏è',
  },
];

// Áî®Êà∑‰ø°ÊÅØ
const userInfo = {
  id: '1',
  username: 'admin',
  displayName: 'Admin User',
  avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=admin',
  roles: ['admin'],
};

// Ë∑ØÁî±ÈÄÇÈÖçÂô®
const router = useRouter();
const route = useRoute();
const routerConfig = useVueRouterAdapter(router, route);

// ‰∫ã‰ª∂Â§ÑÁêÜ
const handleLogout = () => {
  if (confirm('Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÁôªÂΩïÂêóÔºü')) {
    console.log('Logout');
    router.push('/login');
  }
};

const handleSearch = (keyword: string) => {
  console.log('Search:', keyword);
};

const handleRefresh = () => {
  console.log('Refresh page');
  window.location.reload();
};

const handleLockScreen = () => {
  console.log('Lock screen');
};
</script>

<template>
  <!-- 
    BasicLayout Â∑≤ÂÜÖÁΩÆÔºö
    - PreferencesProviderÔºàÂÅèÂ•ΩËÆæÁΩÆ‰∏ä‰∏ãÊñáÔºâ
    - PreferencesDrawerÔºàÂÅèÂ•ΩËÆæÁΩÆÊäΩÂ±âÔºâ
    - ÂÅèÂ•ΩËÆæÁΩÆÊåâÈíÆÔºàÂè≥‰æßÂõ∫ÂÆöÔºâ
    Áî®Êà∑Êó†ÈúÄÊâãÂä®ÈÖçÁΩÆÔºÅ
  -->
  <!-- 
    ‰∏ç‰º†ÈÄí layout Â±ûÊÄßÔºåËÆ©Â∏ÉÂ±ÄÂìçÂ∫îÂÅèÂ•ΩËÆæÁΩÆÁöÑÂèòÂåñ
    Áî®Êà∑ÂèØ‰ª•ÈÄöËøáÂÅèÂ•ΩËÆæÁΩÆÈù¢ÊùøÂàáÊç¢Â∏ÉÂ±ÄÁ±ªÂûã
  -->
  <BasicLayout
    :menus="menus"
    :router="routerConfig"
    :user-info="userInfo"
    :logo="{ source: 'https://vitejs.dev/logo.svg' }"
    app-name="Admin"
    locale="zh-CN"
    @logout="handleLogout"
    @global-search="handleSearch"
    @refresh="handleRefresh"
    @lock-screen="handleLockScreen"
  >
    <!-- ÂÜÖÂÆπÂå∫Âüü -->
    <template #default>
      <router-view v-slot="{ Component }">
        <transition name="fade-slide" mode="out-in">
          <component :is="Component" />
        </transition>
      </router-view>
    </template>

    <!-- È°µËÑöÊèíÊßΩ -->
    <template #footer-center>
      <div class="text-center text-sm text-gray-500 py-4">
        Copyright ¬© 2024 Admin Core. All rights reserved.
      </div>
    </template>
  </BasicLayout>
</template>

<style>
/* ÂÖ®Â±ÄÊ†∑Âºè */
html, body, #app {
  margin: 0;
  padding: 0;
  height: 100%;
}
</style>
